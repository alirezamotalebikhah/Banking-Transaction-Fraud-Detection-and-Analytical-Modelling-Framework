#Set IP
alireza@alireza-VMware-Virtual-Platform:~/projects/project3/01-rev$ cat /etc/hosts
127.0.0.1 localhost
127.0.1.1 alireza-VMware-Virtual-Platform
172.20.0.2 namenode
172.20.0.3 datanode
172.20.0.4 hive-metastore-postgresql
172.20.0.5 hive-metastore
172.20.0.6 hive-server
172.20.0.7 kafka
172.20.0.8 zookeeper
172.20.0.9 spark
172.20.0.10 clickhouse

# The following lines are desirable for IPv6 capable hosts
::1     ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
alireza@alireza-VMware-Virtual-Platform:~/projects/project3/01-rev$ 



#Containers
alireza@alireza-VMware-Virtual-Platform:~/projects/project3/01-rev$ docker ps
CONTAINER ID   IMAGE                                             COMMAND                  CREATED         STATUS                   PORTS                                                                                            NAMES
25addb052f33   bde2020/hive:2.3.2-postgresql-metastore           "entrypoint.sh /bin/…"   5 minutes ago   Up 5 minutes             0.0.0.0:10000->10000/tcp, :::10000->10000/tcp, 10002/tcp                                         hive-server
de4264d62d3f   bde2020/hive:2.3.2-postgresql-metastore           "entrypoint.sh /opt/…"   5 minutes ago   Up 5 minutes             10000/tcp, 0.0.0.0:9083->9083/tcp, :::9083->9083/tcp, 10002/tcp                                  hive-metastore
35827a5b3a70   confluentinc/cp-kafka:7.5.0                       "/etc/confluent/dock…"   5 minutes ago   Up 5 minutes             0.0.0.0:9092->9092/tcp, :::9092->9092/tcp                                                        kafka
d88139882721   bde2020/hadoop-datanode:2.0.0-hadoop2.7.4-java8   "/entrypoint.sh /run…"   5 minutes ago   Up 5 minutes (healthy)   0.0.0.0:50010->50010/tcp, :::50010->50010/tcp, 50075/tcp                                         datanode
acf58e1ac878   apache/spark:3.5.1                                "/opt/entrypoint.sh …"   5 minutes ago   Up 5 minutes             0.0.0.0:7077->7077/tcp, :::7077->7077/tcp, 0.0.0.0:8080->8080/tcp, :::8080->8080/tcp             spark
e3bf0ddd2588   clickhouse/clickhouse-server:latest               "/entrypoint.sh"         5 minutes ago   Up 5 minutes             0.0.0.0:8123->8123/tcp, :::8123->8123/tcp, 0.0.0.0:9000->9000/tcp, :::9000->9000/tcp, 9009/tcp   clickhouse
426c6b0515cc   confluentinc/cp-zookeeper:7.5.0                   "/etc/confluent/dock…"   5 minutes ago   Up 5 minutes             2888/tcp, 0.0.0.0:2181->2181/tcp, :::2181->2181/tcp, 3888/tcp                                    zookeeper
1659f9c1eee0   bde2020/hadoop-namenode:2.0.0-hadoop2.7.4-java8   "/entrypoint.sh /run…"   5 minutes ago   Up 5 minutes (healthy)   0.0.0.0:8020->8020/tcp, :::8020->8020/tcp, 0.0.0.0:50070->50070/tcp, :::50070->50070/tcp         namenode
b8e61527f5fa   bde2020/hive-metastore-postgresql:2.3.0           "/docker-entrypoint.…"   5 minutes ago   Up 5 minutes             0.0.0.0:5432->5432/tcp, :::5432->5432/tcp                                                        hive-metastore-postgresql
alireza@alireza-VMware-Virtual-Platform:~/projects/project3/01-rev$ 

#Creater Kafka Topic
alireza@alireza-VMware-Virtual-Platform:~/projects/project3/01-rev$ docker exec -it kafka bash
[appuser@kafka ~]$ kafka-topics --create --topic bank-transactions --bootstrap-server kafka:9092 --partitions 1 --replication-factor 1
Created topic bank-transactions.
[appuser@kafka ~]$ kafka-topics --list --bootstrap-server kafka:9092
bank-transactions
[appuser@kafka ~]$ exit
alireza@alireza-VMware-Virtual-Platform:~/projects/project3/01-rev$ 

#sent to kafka
Message Deliver to bank-transactions [0]
Message Deliver to bank-transactions [0]
Message Deliver to bank-transactions [0]
Message Deliver to bank-transactions [0]
Message Deliver to bank-transactions [0]
Message Deliver to bank-transactions [0]
Message Deliver to bank-transactions [0]
Message Deliver to bank-transactions [0]
Message Deliver to bank-transactions [0]
Message Deliver to bank-transactions [0]
Message Deliver to bank-transactions [0]
Message Deliver to bank-transactions [0]
Message Deliver to bank-transactions [0]
Message Deliver to bank-transactions [0]
Message Deliver to bank-transactions [0]
all data Sent succesfully
(env) alireza@alireza-VMware-Virtual-Platform:~/projects/project3/01-rev$ 

#see data on kafka
{"transaction_id": "100000718315", "customer_id": "ctid333031290", "transaction_type": "Deposit", "amount": "2475407.0", "currency": "IRR", "timestamp": "2024-07-29 05:39:17"}
{"transaction_id": "100000321879", "customer_id": "ctid751302422", "transaction_type": "Withdrawal", "amount": "449460.0", "currency": "IRR", "timestamp": "2024-06-25 04:36:17"}
{"transaction_id": "100000787201", "customer_id": "ctid759537790", "transaction_type": "Withdrawal", "amount": "4858597.0", "currency": "IRR", "timestamp": "2024-06-25 20:38:12"}
{"transaction_id": "100000064820", "customer_id": "ctid746650272", "transaction_type": "Withdrawal", "amount": "936372.0", "currency": "IRR", "timestamp": "2024-11-08 11:31:07"}
{"transaction_id": "100000329365", "customer_id": "ctid958352125", "transaction_type": "Withdrawal", "amount": "4855014.0", "currency": "IRR", "timestamp": "2024-07-04 04:39:12"}
{"transaction_id": "100000041090", "customer_id": "ctid226313039", "transaction_type": "Deposit", "amount": "3916039.0", "currency": "IRR", "timestamp": "2024-08-11 16:34:36"}
{"transaction_id": "100000278167", "customer_id": "ctid162049137", "transaction_type": "Transfer", "amount": "1950473.0", "currency": "IRR", "timestamp": "2024-03-21 11:15:13"}
{"transaction_id": "100000191335", "customer_id": "ctid214271273", "transaction_type": "Deposit", "amount": "1437960.0", "currency": "IRR", "timestamp": "2024-04-17 08:21:01"}
{"transaction_id": "100000175203", "customer_id": "ctid337985080", "transaction_type": "Transfer", "amount": "3763290.0", "currency": "IRR", "timestamp": "2024-06-06 12:02:29"}
{"transaction_id": "100000912756", "customer_id": "ctid279713916", "transaction_type": "Withdrawal", "amount": "1621661.0", "currency": "IRR", "timestamp": "2024-03-28 00:29:23"}
{"transaction_id": "100000899159", "customer_id": "ctid545890964", "transaction_type": "Withdrawal", "amount": "536277.0", "currency": "IRR", "timestamp": "2024-12-02 00:51:25"}
{"transaction_id": "100000087498", "customer_id": "ctid544976023", "transaction_type": "Withdrawal", "amount": "4726137.0", "currency": "IRR", "timestamp": "2024-05-06 11:42:01"}
{"transaction_id": "100000954698", "customer_id": "ctid996547764", "transaction_type": "Withdrawal", "amount": "2182506.0", "currency": "IRR", "timestamp": "2024-01-07 03:58:20"}
{"transaction_id": "100000521430", "customer_id": "ctid229990128", "transaction_type": "Withdrawal", "amount": "3893303.0", "currency": "IRR", "timestamp": "2024-11-15 12:05:01"}
{"transaction_id": "100000999890", "customer_id": "ctid376730256", "transaction_type": "Transfer", "amount": "3811238.0", "currency": "IRR", "timestamp": "2024-07-30 11:01:14"}
{"transaction_id": "100000137337", "customer_id": "ctid390798162", "transaction_type": "Transfer", "amount": "380181.0", "currency": "IRR", "timestamp": "2024-11-04 23:45:06"}
{"transaction_id": "100000054886", "customer_id": "ctid704509787", "transaction_type": "Withdrawal", "amount": "1584522.0", "currency": "IRR", "timestamp": "2024-06-26 16:37:18"}
{"transaction_id": "100000732180", "customer_id": "ctid996098961", "transaction_type": "Deposit", "amount": "1526381.0", "currency": "IRR", "timestamp": "2024-12-09 15:53:36"}
{"transaction_id": "100000110268", "customer_id": "ctid187296858", "transaction_type": "Deposit", "amount": "3505004.0", "currency": "IRR", "timestamp": "2024-05-23 21:49:39"}
{"transaction_id": "100000644167", "customer_id": "ctid603192960", "transaction_type": "Deposit", "amount": "4548167.0", "currency": "IRR", "timestamp": "2024-11-20 13:27:15"}
{"transaction_id": "100000259178", "customer_id": "ctid495989341", "transaction_type": "Deposit", "amount": "2432161.0", "currency": "IRR", "timestamp": "2024-07-03 00:59:27"}
{"transaction_id": "100000365838", "customer_id": "ctid630597290", "transaction_type": "Transfer", "amount": "131276.0", "currency": "IRR", "timestamp": "2024-11-13 07:48:09"}
{"transaction_id": "100000131932", "customer_id": "ctid566629823", "transaction_type": "Deposit", "amount": "239227719.0", "currency": "IRR", "timestamp": "2024-08-23 17:14:47"}
{"transaction_id": "100000671155", "customer_id": "ctid160590965", "transaction_type": "Withdrawal", "amount": "3175965.0", "currency": "IRR", "timestamp": "2024-01-10 18:38:57"}
{"transaction_id": "100000121958", "customer_id": "ctid173729400", "transaction_type": "Transfer", "amount": "365509.0", "currency": "IRR", "timestamp": "2024-06-16 10:37:19"}
q^CProcessed a total of 1000000 messages
[appuser@kafka ~]$ exit
(env) alireza@alireza-VMware-Virtual-Platform:~/projects/project3/01-rev$ 

#creater transaction_raw table in hive:
(env) alireza@alireza-VMware-Virtual-Platform:~/projects/project3/01-rev$ docker exec -it hive-server bash
root@25addb052f33:/opt# beeline -u jdbc:hive2://localhost:10000
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/opt/hive/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/opt/hadoop-2.7.4/share/hadoop/common/lib/slf4j-log4j12-1.7.10.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Connecting to jdbc:hive2://localhost:10000
Connected to: Apache Hive (version 2.3.2)
Driver: Hive JDBC (version 2.3.2)
Transaction isolation: TRANSACTION_REPEATABLE_READ
Beeline version 2.3.2 by Apache Hive
0: jdbc:hive2://localhost:10000> CREATE EXTERNAL TABLE IF NOT EXISTS transaction_raw (
. . . . . . . . . . . . . . . .>     transaction_id      STRING,
. . . . . . . . . . . . . . . .>     customer_id         STRING,
. . . . . . . . . . . . . . . .>     transaction_type    STRING,
. . . . . . . . . . . . . . . .>     amount              DOUBLE,
. . . . . . . . . . . . . . . .>     currency            STRING,
. . . . . . . . . . . . . . . .>     txn_timestamp       STRING
. . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . .> PARTITIONED BY (
. . . . . . . . . . . . . . . .>     txn_date STRING,
. . . . . . . . . . . . . . . .>     txn_hour STRING
. . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . .> STORED AS PARQUET
. . . . . . . . . . . . . . . .> LOCATION '/user/hive/warehouse/transaction_raw/';
No rows affected (0.455 seconds)
0: jdbc:hive2://localhost:10000> select * from tra
trailing      transaction   translate     translation   
0: jdbc:hive2://localhost:10000> select * from transaction_raw;
+---------------------------------+------------------------------+-----------------------------------+-------------------------+---------------------------+--------------------------------+---------------------------+---------------------------+
| transaction_raw.transaction_id  | transaction_raw.customer_id  | transaction_raw.transaction_type  | transaction_raw.amount  | transaction_raw.currency  | transaction_raw.txn_timestamp  | transaction_raw.txn_date  | transaction_raw.txn_hour  |
+---------------------------------+------------------------------+-----------------------------------+-------------------------+---------------------------+--------------------------------+---------------------------+---------------------------+
+---------------------------------+------------------------------+-----------------------------------+-------------------------+---------------------------+--------------------------------+---------------------------+---------------------------+
No rows selected (1.069 seconds)
0: jdbc:hive2://localhost:10000> SET hive.exec.dynamic.partition = true;
No rows affected (0.006 seconds)
0: jdbc:hive2://localhost:10000> SET hive.exec.dynamic.partition.mode = nonstrict;
No rows affected (0.004 seconds)
0: jdbc:hive2://localhost:10000> 

#run spark
(env) alireza@alireza-VMware-Virtual-Platform:~/projects/project3/01-rev$ spark-submit   --master local[*]   --packages org.apache.spark:spark-sql-kafka-0-10_2.12:3.5.1   first-spark-job.py
25/11/27 12:14:57 WARN Utils: Your hostname, alireza-VMware-Virtual-Platform resolves to a loopback address: 127.0.1.1; using 192.168.40.128 instead (on interface ens33)
25/11/27 12:14:57 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
:: loading settings :: url = jar:file:/home/alireza/projects/project3/01-rev/env/lib/python3.12/site-packages/pyspark/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
Ivy Default Cache set to: /home/alireza/.ivy2/cache
The jars for the packages stored in: /home/alireza/.ivy2/jars
org.apache.spark#spark-sql-kafka-0-10_2.12 added as a dependency
:: resolving dependencies :: org.apache.spark#spark-submit-parent-e8d943c2-6ba2-47b3-b49f-516e8037f7b3;1.0
	confs: [default]
	found org.apache.spark#spark-sql-kafka-0-10_2.12;3.5.1 in central
	found org.apache.spark#spark-token-provider-kafka-0-10_2.12;3.5.1 in central
	found org.apache.kafka#kafka-clients;3.4.1 in central
	found org.lz4#lz4-java;1.8.0 in central
	found org.xerial.snappy#snappy-java;1.1.10.3 in central
	found org.slf4j#slf4j-api;2.0.7 in central
	found org.apache.hadoop#hadoop-client-runtime;3.3.4 in central
	found org.apache.hadoop#hadoop-client-api;3.3.4 in central
	found commons-logging#commons-logging;1.1.3 in central
	found com.google.code.findbugs#jsr305;3.0.0 in central
	found org.apache.commons#commons-pool2;2.11.1 in central
:: resolution report :: resolve 335ms :: artifacts dl 8ms
	:: modules in use:
	com.google.code.findbugs#jsr305;3.0.0 from central in [default]
	commons-logging#commons-logging;1.1.3 from central in [default]
	org.apache.commons#commons-pool2;2.11.1 from central in [default]
	org.apache.hadoop#hadoop-client-api;3.3.4 from central in [default]
	org.apache.hadoop#hadoop-client-runtime;3.3.4 from central in [default]
	org.apache.kafka#kafka-clients;3.4.1 from central in [default]
	org.apache.spark#spark-sql-kafka-0-10_2.12;3.5.1 from central in [default]
	org.apache.spark#spark-token-provider-kafka-0-10_2.12;3.5.1 from central in [default]
	org.lz4#lz4-java;1.8.0 from central in [default]
	org.slf4j#slf4j-api;2.0.7 from central in [default]
	org.xerial.snappy#snappy-java;1.1.10.3 from central in [default]
	---------------------------------------------------------------------
	|                  |            modules            ||   artifacts   |
	|       conf       | number| search|dwnlded|evicted|| number|dwnlded|
	---------------------------------------------------------------------
	|      default     |   11  |   0   |   0   |   0   ||   11  |   0   |
	---------------------------------------------------------------------
:: retrieving :: org.apache.spark#spark-submit-parent-e8d943c2-6ba2-47b3-b49f-516e8037f7b3
	confs: [default]
	0 artifacts copied, 11 already retrieved (0kB/8ms)
25/11/27 12:14:58 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
25/11/27 12:14:59 INFO SparkContext: Running Spark version 3.5.1
25/11/27 12:14:59 INFO SparkContext: OS info Linux, 6.14.0-36-generic, amd64
25/11/27 12:14:59 INFO SparkContext: Java version 21.0.9
25/11/27 12:14:59 INFO ResourceUtils: ==============================================================
25/11/27 12:14:59 INFO ResourceUtils: No custom resources configured for spark.driver.
25/11/27 12:14:59 INFO ResourceUtils: ==============================================================
25/11/27 12:14:59 INFO SparkContext: Submitted application: KafkaToHive
25/11/27 12:14:59 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
25/11/27 12:14:59 INFO ResourceProfile: Limiting resource is cpu
25/11/27 12:14:59 INFO ResourceProfileManager: Added ResourceProfile id: 0
25/11/27 12:14:59 INFO SecurityManager: Changing view acls to: alireza
25/11/27 12:14:59 INFO SecurityManager: Changing modify acls to: alireza
25/11/27 12:14:59 INFO SecurityManager: Changing view acls groups to: 
25/11/27 12:14:59 INFO SecurityManager: Changing modify acls groups to: 
25/11/27 12:14:59 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: alireza; groups with view permissions: EMPTY; users with modify permissions: alireza; groups with modify permissions: EMPTY
25/11/27 12:14:59 INFO Utils: Successfully started service 'sparkDriver' on port 34331.
25/11/27 12:14:59 INFO SparkEnv: Registering MapOutputTracker
25/11/27 12:14:59 INFO SparkEnv: Registering BlockManagerMaster
25/11/27 12:14:59 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
25/11/27 12:14:59 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
25/11/27 12:14:59 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
25/11/27 12:14:59 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-7a0ecf7b-35ae-4504-9aad-370a4f951a21
25/11/27 12:14:59 INFO MemoryStore: MemoryStore started with capacity 434.4 MiB
25/11/27 12:14:59 INFO SparkEnv: Registering OutputCommitCoordinator
25/11/27 12:14:59 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
25/11/27 12:14:59 INFO Utils: Successfully started service 'SparkUI' on port 4040.
25/11/27 12:14:59 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar at spark://192.168.40.128:34331/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar at spark://192.168.40.128:34331/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/org.apache.kafka_kafka-clients-3.4.1.jar at spark://192.168.40.128:34331/jars/org.apache.kafka_kafka-clients-3.4.1.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/com.google.code.findbugs_jsr305-3.0.0.jar at spark://192.168.40.128:34331/jars/com.google.code.findbugs_jsr305-3.0.0.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/org.apache.commons_commons-pool2-2.11.1.jar at spark://192.168.40.128:34331/jars/org.apache.commons_commons-pool2-2.11.1.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar at spark://192.168.40.128:34331/jars/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/org.lz4_lz4-java-1.8.0.jar at spark://192.168.40.128:34331/jars/org.lz4_lz4-java-1.8.0.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/org.xerial.snappy_snappy-java-1.1.10.3.jar at spark://192.168.40.128:34331/jars/org.xerial.snappy_snappy-java-1.1.10.3.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/org.slf4j_slf4j-api-2.0.7.jar at spark://192.168.40.128:34331/jars/org.slf4j_slf4j-api-2.0.7.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-api-3.3.4.jar at spark://192.168.40.128:34331/jars/org.apache.hadoop_hadoop-client-api-3.3.4.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/commons-logging_commons-logging-1.1.3.jar at spark://192.168.40.128:34331/jars/commons-logging_commons-logging-1.1.3.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar at file:///home/alireza/.ivy2/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO Utils: Copying /home/alireza/.ivy2/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar
25/11/27 12:14:59 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar at file:///home/alireza/.ivy2/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO Utils: Copying /home/alireza/.ivy2/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar
25/11/27 12:14:59 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/org.apache.kafka_kafka-clients-3.4.1.jar at file:///home/alireza/.ivy2/jars/org.apache.kafka_kafka-clients-3.4.1.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO Utils: Copying /home/alireza/.ivy2/jars/org.apache.kafka_kafka-clients-3.4.1.jar to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.apache.kafka_kafka-clients-3.4.1.jar
25/11/27 12:14:59 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/com.google.code.findbugs_jsr305-3.0.0.jar at file:///home/alireza/.ivy2/jars/com.google.code.findbugs_jsr305-3.0.0.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO Utils: Copying /home/alireza/.ivy2/jars/com.google.code.findbugs_jsr305-3.0.0.jar to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/com.google.code.findbugs_jsr305-3.0.0.jar
25/11/27 12:14:59 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/org.apache.commons_commons-pool2-2.11.1.jar at file:///home/alireza/.ivy2/jars/org.apache.commons_commons-pool2-2.11.1.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO Utils: Copying /home/alireza/.ivy2/jars/org.apache.commons_commons-pool2-2.11.1.jar to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.apache.commons_commons-pool2-2.11.1.jar
25/11/27 12:14:59 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar at file:///home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO Utils: Copying /home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar
25/11/27 12:14:59 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/org.lz4_lz4-java-1.8.0.jar at file:///home/alireza/.ivy2/jars/org.lz4_lz4-java-1.8.0.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO Utils: Copying /home/alireza/.ivy2/jars/org.lz4_lz4-java-1.8.0.jar to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.lz4_lz4-java-1.8.0.jar
25/11/27 12:14:59 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/org.xerial.snappy_snappy-java-1.1.10.3.jar at file:///home/alireza/.ivy2/jars/org.xerial.snappy_snappy-java-1.1.10.3.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO Utils: Copying /home/alireza/.ivy2/jars/org.xerial.snappy_snappy-java-1.1.10.3.jar to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.xerial.snappy_snappy-java-1.1.10.3.jar
25/11/27 12:14:59 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/org.slf4j_slf4j-api-2.0.7.jar at file:///home/alireza/.ivy2/jars/org.slf4j_slf4j-api-2.0.7.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO Utils: Copying /home/alireza/.ivy2/jars/org.slf4j_slf4j-api-2.0.7.jar to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.slf4j_slf4j-api-2.0.7.jar
25/11/27 12:14:59 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-api-3.3.4.jar at file:///home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-api-3.3.4.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO Utils: Copying /home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-api-3.3.4.jar to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.apache.hadoop_hadoop-client-api-3.3.4.jar
25/11/27 12:14:59 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/commons-logging_commons-logging-1.1.3.jar at file:///home/alireza/.ivy2/jars/commons-logging_commons-logging-1.1.3.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO Utils: Copying /home/alireza/.ivy2/jars/commons-logging_commons-logging-1.1.3.jar to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/commons-logging_commons-logging-1.1.3.jar
25/11/27 12:14:59 INFO Executor: Starting executor ID driver on host 192.168.40.128
25/11/27 12:14:59 INFO Executor: OS info Linux, 6.14.0-36-generic, amd64
25/11/27 12:14:59 INFO Executor: Java version 21.0.9
25/11/27 12:14:59 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
25/11/27 12:14:59 INFO Executor: Created or updated repl class loader org.apache.spark.util.MutableURLClassLoader@3aa7feda for default.
25/11/27 12:14:59 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO Utils: /home/alireza/.ivy2/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar has been previously copied to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar
25/11/27 12:14:59 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/org.apache.kafka_kafka-clients-3.4.1.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO Utils: /home/alireza/.ivy2/jars/org.apache.kafka_kafka-clients-3.4.1.jar has been previously copied to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.apache.kafka_kafka-clients-3.4.1.jar
25/11/27 12:14:59 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO Utils: /home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar has been previously copied to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar
25/11/27 12:14:59 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO Utils: /home/alireza/.ivy2/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar has been previously copied to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar
25/11/27 12:14:59 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/org.slf4j_slf4j-api-2.0.7.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO Utils: /home/alireza/.ivy2/jars/org.slf4j_slf4j-api-2.0.7.jar has been previously copied to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.slf4j_slf4j-api-2.0.7.jar
25/11/27 12:14:59 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/org.xerial.snappy_snappy-java-1.1.10.3.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO Utils: /home/alireza/.ivy2/jars/org.xerial.snappy_snappy-java-1.1.10.3.jar has been previously copied to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.xerial.snappy_snappy-java-1.1.10.3.jar
25/11/27 12:14:59 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/commons-logging_commons-logging-1.1.3.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO Utils: /home/alireza/.ivy2/jars/commons-logging_commons-logging-1.1.3.jar has been previously copied to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/commons-logging_commons-logging-1.1.3.jar
25/11/27 12:14:59 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/com.google.code.findbugs_jsr305-3.0.0.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO Utils: /home/alireza/.ivy2/jars/com.google.code.findbugs_jsr305-3.0.0.jar has been previously copied to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/com.google.code.findbugs_jsr305-3.0.0.jar
25/11/27 12:14:59 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/org.apache.commons_commons-pool2-2.11.1.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO Utils: /home/alireza/.ivy2/jars/org.apache.commons_commons-pool2-2.11.1.jar has been previously copied to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.apache.commons_commons-pool2-2.11.1.jar
25/11/27 12:14:59 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-api-3.3.4.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO Utils: /home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-api-3.3.4.jar has been previously copied to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.apache.hadoop_hadoop-client-api-3.3.4.jar
25/11/27 12:14:59 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/org.lz4_lz4-java-1.8.0.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO Utils: /home/alireza/.ivy2/jars/org.lz4_lz4-java-1.8.0.jar has been previously copied to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.lz4_lz4-java-1.8.0.jar
25/11/27 12:14:59 INFO Executor: Fetching spark://192.168.40.128:34331/jars/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar with timestamp 1764233099143
25/11/27 12:14:59 INFO TransportClientFactory: Successfully created connection to /192.168.40.128:34331 after 19 ms (0 ms spent in bootstraps)
25/11/27 12:14:59 INFO Utils: Fetching spark://192.168.40.128:34331/jars/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/fetchFileTemp9995763896410198189.tmp
25/11/27 12:15:00 INFO Utils: /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/fetchFileTemp9995763896410198189.tmp has been previously copied to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar
25/11/27 12:15:00 INFO Executor: Adding file:/tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar to class loader default
25/11/27 12:15:00 INFO Executor: Fetching spark://192.168.40.128:34331/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar with timestamp 1764233099143
25/11/27 12:15:00 INFO Utils: Fetching spark://192.168.40.128:34331/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/fetchFileTemp15993253333071711176.tmp
25/11/27 12:15:00 INFO Utils: /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/fetchFileTemp15993253333071711176.tmp has been previously copied to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar
25/11/27 12:15:00 INFO Executor: Adding file:/tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar to class loader default
25/11/27 12:15:00 INFO Executor: Fetching spark://192.168.40.128:34331/jars/org.apache.kafka_kafka-clients-3.4.1.jar with timestamp 1764233099143
25/11/27 12:15:00 INFO Utils: Fetching spark://192.168.40.128:34331/jars/org.apache.kafka_kafka-clients-3.4.1.jar to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/fetchFileTemp15886958465791957882.tmp
25/11/27 12:15:00 INFO Utils: /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/fetchFileTemp15886958465791957882.tmp has been previously copied to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.apache.kafka_kafka-clients-3.4.1.jar
25/11/27 12:15:00 INFO Executor: Adding file:/tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.apache.kafka_kafka-clients-3.4.1.jar to class loader default
25/11/27 12:15:00 INFO Executor: Fetching spark://192.168.40.128:34331/jars/org.slf4j_slf4j-api-2.0.7.jar with timestamp 1764233099143
25/11/27 12:15:00 INFO Utils: Fetching spark://192.168.40.128:34331/jars/org.slf4j_slf4j-api-2.0.7.jar to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/fetchFileTemp17414122769811113113.tmp
25/11/27 12:15:00 INFO Utils: /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/fetchFileTemp17414122769811113113.tmp has been previously copied to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.slf4j_slf4j-api-2.0.7.jar
25/11/27 12:15:00 INFO Executor: Adding file:/tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.slf4j_slf4j-api-2.0.7.jar to class loader default
25/11/27 12:15:00 INFO Executor: Fetching spark://192.168.40.128:34331/jars/commons-logging_commons-logging-1.1.3.jar with timestamp 1764233099143
25/11/27 12:15:00 INFO Utils: Fetching spark://192.168.40.128:34331/jars/commons-logging_commons-logging-1.1.3.jar to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/fetchFileTemp16134283559925765002.tmp
25/11/27 12:15:00 INFO Utils: /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/fetchFileTemp16134283559925765002.tmp has been previously copied to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/commons-logging_commons-logging-1.1.3.jar
25/11/27 12:15:00 INFO Executor: Adding file:/tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/commons-logging_commons-logging-1.1.3.jar to class loader default
25/11/27 12:15:00 INFO Executor: Fetching spark://192.168.40.128:34331/jars/org.xerial.snappy_snappy-java-1.1.10.3.jar with timestamp 1764233099143
25/11/27 12:15:00 INFO Utils: Fetching spark://192.168.40.128:34331/jars/org.xerial.snappy_snappy-java-1.1.10.3.jar to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/fetchFileTemp15104639129548991946.tmp
25/11/27 12:15:00 INFO Utils: /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/fetchFileTemp15104639129548991946.tmp has been previously copied to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.xerial.snappy_snappy-java-1.1.10.3.jar
25/11/27 12:15:00 INFO Executor: Adding file:/tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.xerial.snappy_snappy-java-1.1.10.3.jar to class loader default
25/11/27 12:15:00 INFO Executor: Fetching spark://192.168.40.128:34331/jars/org.apache.commons_commons-pool2-2.11.1.jar with timestamp 1764233099143
25/11/27 12:15:00 INFO Utils: Fetching spark://192.168.40.128:34331/jars/org.apache.commons_commons-pool2-2.11.1.jar to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/fetchFileTemp7236562381853526981.tmp
25/11/27 12:15:00 INFO Utils: /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/fetchFileTemp7236562381853526981.tmp has been previously copied to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.apache.commons_commons-pool2-2.11.1.jar
25/11/27 12:15:00 INFO Executor: Adding file:/tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.apache.commons_commons-pool2-2.11.1.jar to class loader default
25/11/27 12:15:00 INFO Executor: Fetching spark://192.168.40.128:34331/jars/com.google.code.findbugs_jsr305-3.0.0.jar with timestamp 1764233099143
25/11/27 12:15:00 INFO Utils: Fetching spark://192.168.40.128:34331/jars/com.google.code.findbugs_jsr305-3.0.0.jar to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/fetchFileTemp6193942595254656955.tmp
25/11/27 12:15:00 INFO Utils: /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/fetchFileTemp6193942595254656955.tmp has been previously copied to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/com.google.code.findbugs_jsr305-3.0.0.jar
25/11/27 12:15:00 INFO Executor: Adding file:/tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/com.google.code.findbugs_jsr305-3.0.0.jar to class loader default
25/11/27 12:15:00 INFO Executor: Fetching spark://192.168.40.128:34331/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar with timestamp 1764233099143
25/11/27 12:15:00 INFO Utils: Fetching spark://192.168.40.128:34331/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/fetchFileTemp7221953935241631052.tmp
25/11/27 12:15:00 INFO Utils: /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/fetchFileTemp7221953935241631052.tmp has been previously copied to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar
25/11/27 12:15:00 INFO Executor: Adding file:/tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar to class loader default
25/11/27 12:15:00 INFO Executor: Fetching spark://192.168.40.128:34331/jars/org.lz4_lz4-java-1.8.0.jar with timestamp 1764233099143
25/11/27 12:15:00 INFO Utils: Fetching spark://192.168.40.128:34331/jars/org.lz4_lz4-java-1.8.0.jar to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/fetchFileTemp9973698635311309128.tmp
25/11/27 12:15:00 INFO Utils: /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/fetchFileTemp9973698635311309128.tmp has been previously copied to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.lz4_lz4-java-1.8.0.jar
25/11/27 12:15:00 INFO Executor: Adding file:/tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.lz4_lz4-java-1.8.0.jar to class loader default
25/11/27 12:15:00 INFO Executor: Fetching spark://192.168.40.128:34331/jars/org.apache.hadoop_hadoop-client-api-3.3.4.jar with timestamp 1764233099143
25/11/27 12:15:00 INFO Utils: Fetching spark://192.168.40.128:34331/jars/org.apache.hadoop_hadoop-client-api-3.3.4.jar to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/fetchFileTemp8697462014140028270.tmp
25/11/27 12:15:00 INFO Utils: /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/fetchFileTemp8697462014140028270.tmp has been previously copied to /tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.apache.hadoop_hadoop-client-api-3.3.4.jar
25/11/27 12:15:00 INFO Executor: Adding file:/tmp/spark-74dd29c4-69ca-440f-b04c-4fecbd7463bd/userFiles-e66fee63-b29c-4800-be4d-872d2a1209bf/org.apache.hadoop_hadoop-client-api-3.3.4.jar to class loader default
25/11/27 12:15:00 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 44635.
25/11/27 12:15:00 INFO NettyBlockTransferService: Server created on 192.168.40.128:44635
25/11/27 12:15:00 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
25/11/27 12:15:00 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 192.168.40.128, 44635, None)
25/11/27 12:15:00 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.40.128:44635 with 434.4 MiB RAM, BlockManagerId(driver, 192.168.40.128, 44635, None)
25/11/27 12:15:00 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 192.168.40.128, 44635, None)
25/11/27 12:15:00 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, 192.168.40.128, 44635, None)
============================================================
Spark Session created
============================================================

Connecting to Kafka...
Kafka connection successful
Data transformation completed

Writing data to HDFS...
Path: /user/hive/warehouse/transaction_raw/
Format: Parquet
Partition: txn_date, txn_hour

25/11/27 12:15:01 WARN ResolveWriteToStream: spark.sql.adaptive.enabled is not supported in streaming DataFrames/Datasets and will be disabled.
============================================================
Streaming started
============================================================

Data is being written to HDFS...
Press Ctrl+C to stop...

25/11/27 12:15:02 WARN AdminClientConfig: These configurations '[key.deserializer, value.deserializer, enable.auto.commit, max.poll.records, auto.offset.reset]' were supplied but are not used yet.
25/11/27 12:15:09 WARN GarbageCollectionMetrics: To enable non-built-in garbage collector(s) List(G1 Concurrent GC), users should configure it(them) to spark.eventLog.gcMetrics.youngGenerationGarbageCollectors or spark.eventLog.gcMetrics.oldGenerationGarbageCollectors

#delete older table
root@1659f9c1eee0:/# hadoop fs -find /user/hive/warehouse/transaction_raw -name "*.parquet" | wc -l
593
root@1659f9c1eee0:/# hadoop fs -find /user/hive/warehouse/transaction_raw -name "*.parquet" | wc -l
690
root@1659f9c1eee0:/# hadoop fs -find /user/hive/warehouse/transaction_raw -name "*.parquet" | wc -l
2345
root@1659f9c1eee0:/# hadoop fs -rm -r /tmp/checkpoint_kafka/
25/11/27 08:44:44 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /tmp/checkpoint_kafka
root@1659f9c1eee0:/# hadoop fs -rm -r /user/hive/warehouse/transaction_raw/*
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/_spark_metadata
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-01
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-02
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-03
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-04
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-05
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-06
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-07
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-08
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-09
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-10
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-11
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-12
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-13
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-14
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-15
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-16
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-17
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-18
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-19
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-20
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-21
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-22
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-23
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-24
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-25
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-26
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-27
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-28
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-29
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-30
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-01-31
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-02-01
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-02-02
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-02-03
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-02-04
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-02-05
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-02-06
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-02-07
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-02-08
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-02-09
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-02-10
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-02-11
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-02-12
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-02-13
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-02-14
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-02-15
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-02-16
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-02-17
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-02-18
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-02-19
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-02-20
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-02-21
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-02-22
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-02-23
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-02-24
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-02-25
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-02-26
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-02-27
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-02-28
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-02-29
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-01
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-02
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-03
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-04
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-05
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-06
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-07
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-08
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-09
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-10
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-11
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-12
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-13
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-14
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-15
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-16
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-17
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-18
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-19
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-20
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-21
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-22
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-23
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-24
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-25
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-26
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-27
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-28
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-29
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-30
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-03-31
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-04-01
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-04-02
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-04-03
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-04-04
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-04-05
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-04-06
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-04-07
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-04-08
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-04-09
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-04-10
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-04-11
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-04-12
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-04-13
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-04-14
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-04-15
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-04-16
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-04-17
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-04-18
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-04-19
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-04-20
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-04-21
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-04-22
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-04-23
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-04-24
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-04-25
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-04-26
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-04-27
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-04-28
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-04-29
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-04-30
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-01
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-02
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-03
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-04
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-05
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-06
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-07
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-08
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-09
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-10
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-11
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-12
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-13
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-14
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-15
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-16
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-17
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-18
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-19
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-20
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-21
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-22
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-23
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-24
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-25
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-26
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-27
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-28
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-29
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-30
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-05-31
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-06-01
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-06-02
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-06-03
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-06-04
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-06-05
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-06-06
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-06-07
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-06-08
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-06-09
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-06-10
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-06-11
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-06-12
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-06-13
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-06-14
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-06-15
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-06-16
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-06-17
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-06-18
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-06-19
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-06-20
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-06-21
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-06-22
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-06-23
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-06-24
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-06-25
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-06-26
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-06-27
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-06-28
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-06-29
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-06-30
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-01
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-02
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-03
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-04
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-05
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-06
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-07
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-08
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-09
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-10
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-11
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-12
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-13
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-14
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-15
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-16
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-17
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-18
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-19
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-20
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-21
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-22
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-23
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-24
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-25
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-26
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-27
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-28
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-29
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-30
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-07-31
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-08-01
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-08-02
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-08-03
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-08-04
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-08-05
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-08-06
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-08-07
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-08-08
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-08-09
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-08-10
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-08-11
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-08-12
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-08-13
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-08-14
25/11/27 08:44:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
Deleted /user/hive/warehouse/transaction_raw/txn_date=2024-08-15
root@1659f9c1eee0:/# hadoop fs -find /user/hive/warehouse/transaction_raw -name "*.parquet" | wc -l
502
root@1659f9c1eee0:/# 

#repair and show new files
0: jdbc:hive2://localhost:10000> MSCK REPAIR TABLE transaction_raw;
No rows affected (1.031 seconds)
0: jdbc:hive2://localhost:10000> SELECT * from transaction_raw limit 100;
+---------------------------------+------------------------------+-----------------------------------+-------------------------+---------------------------+--------------------------------+---------------------------+---------------------------+
| transaction_raw.transaction_id  | transaction_raw.customer_id  | transaction_raw.transaction_type  | transaction_raw.amount  | transaction_raw.currency  | transaction_raw.txn_timestamp  | transaction_raw.txn_date  | transaction_raw.txn_hour  |
+---------------------------------+------------------------------+-----------------------------------+-------------------------+---------------------------+--------------------------------+---------------------------+---------------------------+
| 100000385483                    | ctid958324028                | Transfer                          | 2043441.0               | IRR                       | 2024-01-01 00:47:41            | 2024-01-01                | 00                        |
| 100000659592                    | ctid193708442                | Deposit                           | 2773161.0               | IRR                       | 2024-01-01 00:33:19            | 2024-01-01                | 00                        |
| 100000019618                    | ctid815296539                | Withdrawal                        | 278569.0                | IRR                       | 2024-01-01 00:45:20            | 2024-01-01                | 00                        |
| 100000793867                    | ctid406093479                | Deposit                           | 771646.0                | IRR                       | 2024-01-01 01:34:13            | 2024-01-01                | 01                        |
| 100000293869                    | ctid346515161                | Withdrawal                        | 2.67621411E8            | IRR                       | 2024-01-01 02:24:00            | 2024-01-01                | 02                        |
| 100000573677                    | ctid552682745                | Transfer                          | 3295318.0               | IRR                       | 2024-01-01 03:35:20            | 2024-01-01                | 03                        |
| 100000235879                    | ctid873817352                | Deposit                           | 1336131.0               | IRR                       | 2024-01-01 05:45:04            | 2024-01-01                | 05                        |
| 100000524596                    | ctid523133435                | Transfer                          | 2205835.0               | IRR                       | 2024-01-01 05:23:12            | 2024-01-01                | 05                        |
| 100000411886                    | ctid509864891                | Deposit                           | 167663.0                | IRR                       | 2024-01-01 05:12:17            | 2024-01-01                | 05                        |
| 100000104335                    | ctid941812457                | Transfer                          | 3154477.0               | IRR                       | 2024-01-01 06:34:56            | 2024-01-01                | 06                        |
| 100000258967                    | ctid632232810                | Deposit                           | 4542204.0               | IRR                       | 2024-01-01 06:23:29            | 2024-01-01                | 06                        |
| 100000822359                    | ctid553130062                | Withdrawal                        | 4197991.0               | IRR                       | 2024-01-01 07:42:12            | 2024-01-01                | 07                        |
| 100000068658                    | ctid873817352                | Deposit                           | NULL                    | IRR                       | 2024-01-01 08:24:23            | 2024-01-01                | 08                        |
| 100000533027                    | ctid264743833                | Transfer                          | 2050651.0               | IRR                       | 2024-01-01 09:37:23            | 2024-01-01                | 09                        |
| 100000066971                    | ctid386176188                | Deposit                           | 2162010.0               | IRR                       | 2024-01-01 10:37:16            | 2024-01-01                | 10                        |
| 100000653425                    | ctid264743833                | Deposit                           | 3414478.0               | IRR                       | 2024-01-01 11:29:16            | 2024-01-01                | 11                        |
| 100000983162                    | ctid931946112                | Withdrawal                        | 1086252.0               | IRR                       | 2024-01-01 11:47:20            | 2024-01-01                | 11                        |
| 100000088742                    | ctid614743035                | Deposit                           | 372262.0                | IRR                       | 2024-01-01 11:20:05            | 2024-01-01                | 11                        |
| 100000923236                    | ctid168512459                | Withdrawal                        | 4325383.0               | IRR                       | 2024-01-01 12:32:49            | 2024-01-01                | 12                        |
| 100000418258                    | ctid754390844                | Withdrawal                        | 1246282.0               | IRR                       | 2024-01-01 13:13:49            | 2024-01-01                | 13                        |
| 100000474811                    | ctid960822210                | Withdrawal                        | 3942112.0               | IRR                       | 2024-01-01 15:28:53            | 2024-01-01                | 15                        |
| 100000315270                    | ctid858301913                | Transfer                          | 1402546.0               | IRR                       | 2024-01-01 19:44:21            | 2024-01-01                | 19                        |
| 100000363263                    | ctid892950069                | Deposit                           | 4360023.0               | IRR                       | 2024-01-01 20:50:08            | 2024-01-01                | 20                        |
| 100000982084                    | ctid193708442                | Deposit                           | 4781611.0               | IRR                       | 2024-01-01 20:39:42            | 2024-01-01                | 20                        |
| 100000050803                    | ctid193708442                | Withdrawal                        | NULL                    | IRR                       | 2024-01-01 21:46:01            | 2024-01-01                | 21                        |
| 100000124021                    | ctid955255543                | Withdrawal                        | 2197475.0               | IRR                       | 2024-01-01 22:13:35            | 2024-01-01                | 22                        |
| 100000417684                    | ctid816616956                | Withdrawal                        | 2240110.0               | IRR                       | 2024-01-01 22:17:30            | 2024-01-01                | 22                        |
| 100000090877                    | ctid489436624                | Deposit                           | NULL                    | IRR                       | 2024-01-02 01:51:29            | 2024-01-02                | 01                        |
| 100000849466                    | ctid975116342                | Transfer                          | 4130495.0               | IRR                       | 2024-01-02 05:28:51            | 2024-01-02                | 05                        |
| 100000191585                    | ctid141619243                | Deposit                           | NULL                    | IRR                       | 2024-01-02 05:56:56            | 2024-01-02                | 05                        |
| 100000419220                    | ctid987555936                | Withdrawal                        | 2612551.0               | IRR                       | 2024-01-02 13:46:52            | 2024-01-02                | 13                        |
| 100000841962                    | ctid297845629                | Deposit                           | 2017051.0               | IRR                       | 2024-01-02 15:16:15            | 2024-01-02                | 15                        |
| 100000745974                    | ctid447027594                | Transfer                          | 3218050.0               | IRR                       | 2024-01-02 15:29:00            | 2024-01-02                | 15                        |
| 100000211635                    | ctid377166119                | Transfer                          | 3826730.0               | IRR                       | 2024-01-02 17:18:55            | 2024-01-02                | 17                        |
| 100000859353                    | ctid467970919                | Deposit                           | 3971780.0               | IRR                       | 2024-01-02 18:51:50            | 2024-01-02                | 18                        |
| 100000711713                    | ctid157552152                | Transfer                          | 3433004.0               | IRR                       | 2024-01-03 00:08:03            | 2024-01-03                | 00                        |
| 100000101127                    | ctid801816239                | Transfer                          | 1254150.0               | IRR                       | 2024-01-03 00:01:00            | 2024-01-03                | 00                        |
| 100000527943                    | ctid743143335                | Deposit                           | 3720358.0               | IRR                       | 2024-01-03 02:43:46            | 2024-01-03                | 02                        |
| 100000059157                    | ctid118104314                | Deposit                           | 666764.0                | IRR                       | 2024-01-03 03:06:34            | 2024-01-03                | 03                        |
| 100000733580                    | ctid268207288                | Withdrawal                        | 2558279.0               | IRR                       | 2024-01-03 06:40:32            | 2024-01-03                | 06                        |
| 100000083449                    | ctid592048811                | Deposit                           | 497501.0                | IRR                       | 2024-01-03 11:35:13            | 2024-01-03                | 11                        |
| 100000762568                    | ctid497627749                | Transfer                          | 1224144.0               | IRR                       | 2024-01-03 12:28:03            | 2024-01-03                | 12                        |
| 100000329181                    | ctid136950803                | Withdrawal                        | 4418157.0               | IRR                       | 2024-01-03 13:52:27            | 2024-01-03                | 13                        |
| 100000990306                    | ctid806810819                | Transfer                          | 1847581.0               | IRR                       | 2024-01-03 14:07:37            | 2024-01-03                | 14                        |
| 100000468079                    | ctid416258386                | Withdrawal                        | 2245575.0               | IRR                       | 2024-01-03 14:49:22            | 2024-01-03                | 14                        |
| 100000087104                    | ctid353300602                | Withdrawal                        | 4355222.0               | IRR                       | 2024-01-03 17:59:13            | 2024-01-03                | 17                        |
| 100000924110                    | ctid634341073                | Deposit                           | 2.43262652E8            | IRR                       | 2024-01-03 18:56:52            | 2024-01-03                | 18                        |
| 100000607946                    | ctid395733812                | Deposit                           | 4925460.0               | IRR                       | 2024-01-04 04:05:15            | 2024-01-04                | 04                        |
| 100000600959                    | ctid539145231                | Deposit                           | 3134428.0               | IRR                       | 2024-01-04 04:33:16            | 2024-01-04                | 04                        |
| 100000258262                    | ctid949449568                | Transfer                          | 1260799.0               | IRR                       | 2024-01-04 05:45:40            | 2024-01-04                | 05                        |
| 100000793421                    | ctid473644661                | Deposit                           | 2494505.0               | IRR                       | 2024-01-04 10:27:16            | 2024-01-04                | 10                        |
| 100000590269                    | ctid945146328                | Transfer                          | 4688371.0               | IRR                       | 2024-01-04 11:49:04            | 2024-01-04                | 11                        |
| 100000729725                    | ctid171786399                | Transfer                          | 1.07536486E8            | IRR                       | 2024-01-04 12:54:39            | 2024-01-04                | 12                        |
| 100000071412                    | ctid894318271                | Transfer                          | 2722640.0               | IRR                       | 2024-01-04 19:19:00            | 2024-01-04                | 19                        |
| 100000115332                    | ctid753936561                | Deposit                           | 3827674.0               | IRR                       | 2024-01-04 20:19:33            | 2024-01-04                | 20                        |
| 100000372500                    | ctid536645055                | Transfer                          | 3664800.0               | IRR                       | 2024-01-04 21:22:03            | 2024-01-04                | 21                        |
| 100000383014                    | ctid645251464                | Withdrawal                        | 1690499.0               | IRR                       | 2024-01-04 21:23:23            | 2024-01-04                | 21                        |
| 100000940388                    | ctid947000413                | Withdrawal                        | 307981.0                | IRR                       | 2024-01-04 23:35:29            | 2024-01-04                | 23                        |
| 100000151111                    | ctid384543035                | Withdrawal                        | 4921110.0               | IRR                       | 2024-01-05 00:48:18            | 2024-01-05                | 00                        |
| 100000967266                    | ctid710394981                | Transfer                          | 659687.0                | IRR                       | 2024-01-05 01:07:37            | 2024-01-05                | 01                        |
| 100000594452                    | ctid302888358                | Transfer                          | 1833187.0               | IRR                       | 2024-01-05 01:50:31            | 2024-01-05                | 01                        |
| 100000028097                    | ctid291536706                | Transfer                          | 4991845.0               | IRR                       | 2024-01-05 03:57:53            | 2024-01-05                | 03                        |
| 100000270291                    | ctid140197021                | Transfer                          | 3059220.0               | IRR                       | 2024-01-05 08:40:13            | 2024-01-05                | 08                        |
| 100000788136                    | ctid822067990                | Withdrawal                        | 2075278.0               | IRR                       | 2024-01-05 09:39:06            | 2024-01-05                | 09                        |
| 100000237434                    | ctid979406732                | Deposit                           | 1370537.0               | IRR                       | 2024-01-05 13:27:37            | 2024-01-05                | 13                        |
| 100000432743                    | ctid429860423                | Withdrawal                        | 676114.0                | IRR                       | 2024-01-05 13:09:59            | 2024-01-05                | 13                        |
| 100000699155                    | ctid230459046                | Deposit                           | 752317.0                | IRR                       | 2024-01-05 13:07:12            | 2024-01-05                | 13                        |
| 100000554195                    | ctid719063671                | Transfer                          | 581794.0                | IRR                       | 2024-01-05 13:56:21            | 2024-01-05                | 13                        |
| 100000716048                    | ctid816752383                | Withdrawal                        | 1.95427002E8            | IRR                       | 2024-01-05 14:44:08            | 2024-01-05                | 14                        |
| 100000546717                    | ctid605075968                | Deposit                           | 563948.0                | IRR                       | 2024-01-05 14:28:27            | 2024-01-05                | 14                        |
| 100000033612                    | ctid379990775                | Deposit                           | 1034815.0               | IRR                       | 2024-01-05 16:15:09            | 2024-01-05                | 16                        |
| 100000857069                    | ctid305717013                | Transfer                          | 1660959.0               | IRR                       | 2024-01-05 17:09:28            | 2024-01-05                | 17                        |
| 100000938094                    | ctid212431046                | Deposit                           | NULL                    | IRR                       | 2024-01-05 18:02:59            | 2024-01-05                | 18                        |
| 100000839416                    | ctid848520442                | Deposit                           | 4743244.0               | IRR                       | 2024-01-05 18:48:48            | 2024-01-05                | 18                        |
| 100000161165                    | ctid712608676                | Deposit                           | 4526216.0               | IRR                       | 2024-01-05 19:02:56            | 2024-01-05                | 19                        |
| 100000948364                    | ctid379990775                | Transfer                          | 2101599.0               | IRR                       | 2024-01-05 19:25:11            | 2024-01-05                | 19                        |
| 100000737055                    | ctid835650988                | Withdrawal                        | 4338295.0               | IRR                       | 2024-01-05 20:30:10            | 2024-01-05                | 20                        |
| 100000328816                    | ctid393462506                | Deposit                           | NULL                    | IRR                       | 2024-01-06 03:56:29            | 2024-01-06                | 03                        |
| 100000987704                    | ctid786251705                | Withdrawal                        | 1803088.0               | IRR                       | 2024-01-06 05:02:38            | 2024-01-06                | 05                        |
| 100000964597                    | ctid776211834                | Deposit                           | 1299187.0               | IRR                       | 2024-01-06 07:47:50            | 2024-01-06                | 07                        |
| 100000746689                    | ctid453473051                | Withdrawal                        | 4670365.0               | IRR                       | 2024-01-06 09:14:37            | 2024-01-06                | 09                        |
| 100000307237                    | ctid701867140                | Withdrawal                        | 3636968.0               | IRR                       | 2024-01-06 11:54:18            | 2024-01-06                | 11                        |
| 100000600785                    | ctid134634754                | Transfer                          | 4975474.0               | IRR                       | 2024-01-06 13:05:15            | 2024-01-06                | 13                        |
| 100000921401                    | ctid264838477                | Withdrawal                        | 3916633.0               | IRR                       | 2024-01-06 14:48:48            | 2024-01-06                | 14                        |
| 100000155552                    | ctid284394835                | Transfer                          | 8.87427711E8            | IRR                       | 2024-01-06 15:10:36            | 2024-01-06                | 15                        |
| 100000045250                    | ctid705616526                | Withdrawal                        | 1291907.0               | IRR                       | 2024-01-06 15:25:19            | 2024-01-06                | 15                        |
| 100000084894                    | ctid807583143                | Deposit                           | 2910483.0               | IRR                       | 2024-01-06 16:59:47            | 2024-01-06                | 16                        |
| 100000144193                    | ctid440183224                | Deposit                           | 2299208.0               | IRR                       | 2024-01-06 16:46:31            | 2024-01-06                | 16                        |
| 100000359448                    | ctid837876719                | Withdrawal                        | 2829398.0               | IRR                       | 2024-01-06 16:57:12            | 2024-01-06                | 16                        |
| 100000253943                    | ctid268781242                | Transfer                          | 2799403.0               | IRR                       | 2024-01-06 21:00:27            | 2024-01-06                | 21                        |
| 100000166604                    | ctid948622464                | Withdrawal                        | 4796386.0               | IRR                       | 2024-01-06 22:18:07            | 2024-01-06                | 22                        |
| 100000317676                    | ctid559706943                | Transfer                          | 834569.0                | IRR                       | 2024-01-06 23:52:16            | 2024-01-06                | 23                        |
| 100000332989                    | ctid596903287                | Withdrawal                        | NULL                    | IRR                       | 2024-01-07 01:30:36            | 2024-01-07                | 01                        |
| 100000247907                    | ctid418630574                | Transfer                          | 406411.0                | IRR                       | 2024-01-07 02:28:07            | 2024-01-07                | 02                        |
| 100000736362                    | ctid957979392                | Transfer                          | 1399059.0               | IRR                       | 2024-01-07 04:22:44            | 2024-01-07                | 04                        |
| 100000064290                    | ctid729790847                | Deposit                           | 4869321.0               | IRR                       | 2024-01-07 10:13:59            | 2024-01-07                | 10                        |
| 100000691109                    | ctid417751445                | Withdrawal                        | 3086474.0               | IRR                       | 2024-01-07 10:25:59            | 2024-01-07                | 10                        |
| 100000868012                    | ctid486768551                | Transfer                          | 4035389.0               | IRR                       | 2024-01-07 14:41:20            | 2024-01-07                | 14                        |
| 100000514069                    | ctid909767134                | Withdrawal                        | 4849110.0               | IRR                       | 2024-01-07 14:05:02            | 2024-01-07                | 14                        |
| 100000167489                    | ctid828214977                | Transfer                          | 1916080.0               | IRR                       | 2024-01-07 16:20:09            | 2024-01-07                | 16                        |
+---------------------------------+------------------------------+-----------------------------------+-------------------------+---------------------------+--------------------------------+---------------------------+---------------------------+
100 rows selected (0.623 seconds)
0: jdbc:hive2://localhost:10000> 

#new topic for kafka
alireza@alireza-VMware-Virtual-Platform:~$ docker exec -it kafka bash
[appuser@kafka ~]$ kafka-topics --create --topic bank_transaction_clean --bootstrap-server kafka:9092 --partitions 1 --replication-factor 1
WARNING: Due to limitations in metric names, topics with a period ('.') or underscore ('_') could collide. To avoid issues it is best to use either, but not both.
Created topic bank_transaction_clean.
[appuser@kafka ~]$ kafka-topics --create --topic bank_transaction_invalid --bootstrap-server kafka:9092 --partitions 1 --replication-factor 1
WARNING: Due to limitations in metric names, topics with a period ('.') or underscore ('_') could collide. To avoid issues it is best to use either, but not both.
Created topic bank_transaction_invalid.
[appuser@kafka ~]$ kafka-topics --list --bootstrap-server kafka:9092
__consumer_offsets
bank-transactions
bank_transaction_clean
bank_transaction_invalid
[appuser@kafka ~]$ 

#amount not this here
[appuser@kafka ~]$ kafka-console-consumer --topic bank_transaction_clean --from-beginning --bootstrap-server kafka:9092 | head -10
{"transaction_id":"100000987231","customer_id":"ctid885424945","transaction_type":"Withdrawal","amount":4107720.0,"currency":"IRR","txn_timestamp":"2024-09-12 15:46:28","txn_date":"2024-09-12","txn_hour":"15"}
{"transaction_id":"100000567130","customer_id":"ctid280831568","transaction_type":"Withdrawal","amount":1682443.0,"currency":"IRR","txn_timestamp":"2024-10-23 12:48:46","txn_date":"2024-10-23","txn_hour":"12"}
{"transaction_id":"100000500891","customer_id":"ctid456996860","transaction_type":"Transfer","amount":1.36759591E8,"currency":"IRR","txn_timestamp":"2024-07-14 09:00:27","txn_date":"2024-07-14","txn_hour":"09"}
{"transaction_id":"100000055399","customer_id":"ctid802800667","transaction_type":"Transfer","amount":2401906.0,"currency":"IRR","txn_timestamp":"2024-08-25 23:06:15","txn_date":"2024-08-25","txn_hour":"23"}
{"transaction_id":"100000135049","customer_id":"ctid730970219","transaction_type":"Deposit","amount":3421272.0,"currency":"IRR","txn_timestamp":"2024-11-17 18:24:53","txn_date":"2024-11-17","txn_hour":"18"}
{"transaction_id":"100000733378","customer_id":"ctid412692481","transaction_type":"Withdrawal","amount":3831349.0,"currency":"IRR","txn_timestamp":"2024-06-27 13:59:32","txn_date":"2024-06-27","txn_hour":"13"}
{"transaction_id":"100000732057","customer_id":"ctid992974141","transaction_type":"Deposit","amount":2900896.0,"currency":"IRR","txn_timestamp":"2024-01-24 23:40:27","txn_date":"2024-01-24","txn_hour":"23"}
{"transaction_id":"100000051333","customer_id":"ctid776492610","transaction_type":"Transfer","amount":4754977.0,"currency":"IRR","txn_timestamp":"2024-07-15 20:58:58","txn_date":"2024-07-15","txn_hour":"20"}
{"transaction_id":"100000731479","customer_id":"ctid706015372","transaction_type":"Transfer","amount":2361710.0,"currency":"IRR","txn_timestamp":"2024-03-04 03:43:47","txn_date":"2024-03-04","txn_hour":"03"}
{"transaction_id":"100000399758","customer_id":"ctid478046225","transaction_type":"Deposit","amount":2073998.0,"currency":"IRR","txn_timestamp":"2024-09-20 11:31:08","txn_date":"2024-09-20","txn_hour":"11"}
Unable to write to standard out, closing consumer.
Processed a total of 11 messages
[appuser@kafka ~]$ kafka-console-consumer --topic bank_transaction_invalid --from-beginning --bootstrap-server kafka:9092 | head -10
{"transaction_id":"100000079954","customer_id":"ctid771832805","transaction_type":"Withdrawal","currency":"IRR","txn_timestamp":"2024-03-17 11:34:25","txn_date":"2024-03-17","txn_hour":"11"}
{"transaction_id":"100000126314","customer_id":"ctid748753252","transaction_type":"Withdrawal","currency":"IRR","txn_timestamp":"2024-04-26 19:50:36","txn_date":"2024-04-26","txn_hour":"19"}
{"transaction_id":"100000470128","customer_id":"ctid748730085","transaction_type":"Withdrawal","currency":"IRR","txn_timestamp":"2024-09-26 05:20:11","txn_date":"2024-09-26","txn_hour":"05"}
{"transaction_id":"100000802841","customer_id":"ctid137467398","transaction_type":"Withdrawal","currency":"IRR","txn_timestamp":"2024-02-22 23:51:41","txn_date":"2024-02-22","txn_hour":"23"}
{"transaction_id":"100000948560","customer_id":"ctid299430282","transaction_type":"Withdrawal","currency":"IRR","txn_timestamp":"2024-08-26 01:35:42","txn_date":"2024-08-26","txn_hour":"01"}
{"transaction_id":"100000249054","customer_id":"ctid933408997","transaction_type":"Withdrawal","currency":"IRR","txn_timestamp":"2024-09-05 22:06:35","txn_date":"2024-09-05","txn_hour":"22"}
{"transaction_id":"100000257326","customer_id":"ctid271177867","transaction_type":"Withdrawal","currency":"IRR","txn_timestamp":"2024-01-27 00:25:29","txn_date":"2024-01-27","txn_hour":"00"}
{"transaction_id":"100000681605","customer_id":"ctid422758245","transaction_type":"Transfer","currency":"IRR","txn_timestamp":"2024-10-13 16:46:58","txn_date":"2024-10-13","txn_hour":"16"}
{"transaction_id":"100000804754","customer_id":"ctid735082230","transaction_type":"Deposit","currency":"IRR","txn_timestamp":"2024-11-22 12:25:52","txn_date":"2024-11-22","txn_hour":"12"}
{"transaction_id":"100000499234","customer_id":"ctid271031218","transaction_type":"Transfer","currency":"IRR","txn_timestamp":"2024-05-12 20:49:09","txn_date":"2024-05-12","txn_hour":"20"}
Unable to write to standard out, closing consumer.
Processed a total of 13 messages
[appuser@kafka ~]$ 

#run script for split
(env) alireza@alireza-VMware-Virtual-Platform:~/projects/project3/01-rev$ spark-submit   --master local[*]   --packages org.apache.spark:spark-sql-kafka-0-10_2.12:3.5.1   kafka_split.py
25/11/27 14:51:36 WARN Utils: Your hostname, alireza-VMware-Virtual-Platform resolves to a loopback address: 127.0.1.1; using 192.168.40.128 instead (on interface ens33)
25/11/27 14:51:36 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
:: loading settings :: url = jar:file:/home/alireza/projects/project3/01-rev/env/lib/python3.12/site-packages/pyspark/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
Ivy Default Cache set to: /home/alireza/.ivy2/cache
The jars for the packages stored in: /home/alireza/.ivy2/jars
org.apache.spark#spark-sql-kafka-0-10_2.12 added as a dependency
:: resolving dependencies :: org.apache.spark#spark-submit-parent-e1c7036c-79ad-4b9f-b35b-5ffa95ee51b9;1.0
	confs: [default]
	found org.apache.spark#spark-sql-kafka-0-10_2.12;3.5.1 in central
	found org.apache.spark#spark-token-provider-kafka-0-10_2.12;3.5.1 in central
	found org.apache.kafka#kafka-clients;3.4.1 in central
	found org.lz4#lz4-java;1.8.0 in central
	found org.xerial.snappy#snappy-java;1.1.10.3 in central
	found org.slf4j#slf4j-api;2.0.7 in central
	found org.apache.hadoop#hadoop-client-runtime;3.3.4 in central
	found org.apache.hadoop#hadoop-client-api;3.3.4 in central
	found commons-logging#commons-logging;1.1.3 in central
	found com.google.code.findbugs#jsr305;3.0.0 in central
	found org.apache.commons#commons-pool2;2.11.1 in central
:: resolution report :: resolve 421ms :: artifacts dl 14ms
	:: modules in use:
	com.google.code.findbugs#jsr305;3.0.0 from central in [default]
	commons-logging#commons-logging;1.1.3 from central in [default]
	org.apache.commons#commons-pool2;2.11.1 from central in [default]
	org.apache.hadoop#hadoop-client-api;3.3.4 from central in [default]
	org.apache.hadoop#hadoop-client-runtime;3.3.4 from central in [default]
	org.apache.kafka#kafka-clients;3.4.1 from central in [default]
	org.apache.spark#spark-sql-kafka-0-10_2.12;3.5.1 from central in [default]
	org.apache.spark#spark-token-provider-kafka-0-10_2.12;3.5.1 from central in [default]
	org.lz4#lz4-java;1.8.0 from central in [default]
	org.slf4j#slf4j-api;2.0.7 from central in [default]
	org.xerial.snappy#snappy-java;1.1.10.3 from central in [default]
	---------------------------------------------------------------------
	|                  |            modules            ||   artifacts   |
	|       conf       | number| search|dwnlded|evicted|| number|dwnlded|
	---------------------------------------------------------------------
	|      default     |   11  |   0   |   0   |   0   ||   11  |   0   |
	---------------------------------------------------------------------
:: retrieving :: org.apache.spark#spark-submit-parent-e1c7036c-79ad-4b9f-b35b-5ffa95ee51b9
	confs: [default]
	0 artifacts copied, 11 already retrieved (0kB/9ms)
25/11/27 14:51:37 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
25/11/27 14:51:38 INFO SparkContext: Running Spark version 3.5.1
25/11/27 14:51:38 INFO SparkContext: OS info Linux, 6.14.0-36-generic, amd64
25/11/27 14:51:38 INFO SparkContext: Java version 21.0.9
25/11/27 14:51:38 INFO ResourceUtils: ==============================================================
25/11/27 14:51:38 INFO ResourceUtils: No custom resources configured for spark.driver.
25/11/27 14:51:38 INFO ResourceUtils: ==============================================================
25/11/27 14:51:38 INFO SparkContext: Submitted application: KafkaSplitStream
25/11/27 14:51:38 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
25/11/27 14:51:38 INFO ResourceProfile: Limiting resource is cpu
25/11/27 14:51:38 INFO ResourceProfileManager: Added ResourceProfile id: 0
25/11/27 14:51:38 INFO SecurityManager: Changing view acls to: alireza
25/11/27 14:51:38 INFO SecurityManager: Changing modify acls to: alireza
25/11/27 14:51:38 INFO SecurityManager: Changing view acls groups to: 
25/11/27 14:51:38 INFO SecurityManager: Changing modify acls groups to: 
25/11/27 14:51:38 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: alireza; groups with view permissions: EMPTY; users with modify permissions: alireza; groups with modify permissions: EMPTY
25/11/27 14:51:38 INFO Utils: Successfully started service 'sparkDriver' on port 35647.
25/11/27 14:51:38 INFO SparkEnv: Registering MapOutputTracker
25/11/27 14:51:38 INFO SparkEnv: Registering BlockManagerMaster
25/11/27 14:51:38 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
25/11/27 14:51:38 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
25/11/27 14:51:38 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
25/11/27 14:51:38 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-d26aac99-688a-47f9-ab9b-e5a82dd35e81
25/11/27 14:51:38 INFO MemoryStore: MemoryStore started with capacity 434.4 MiB
25/11/27 14:51:38 INFO SparkEnv: Registering OutputCommitCoordinator
25/11/27 14:51:38 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
25/11/27 14:51:38 INFO Utils: Successfully started service 'SparkUI' on port 4040.
25/11/27 14:51:38 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar at spark://192.168.40.128:35647/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar with timestamp 1764242498055
25/11/27 14:51:38 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar at spark://192.168.40.128:35647/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar with timestamp 1764242498055
25/11/27 14:51:38 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/org.apache.kafka_kafka-clients-3.4.1.jar at spark://192.168.40.128:35647/jars/org.apache.kafka_kafka-clients-3.4.1.jar with timestamp 1764242498055
25/11/27 14:51:38 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/com.google.code.findbugs_jsr305-3.0.0.jar at spark://192.168.40.128:35647/jars/com.google.code.findbugs_jsr305-3.0.0.jar with timestamp 1764242498055
25/11/27 14:51:38 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/org.apache.commons_commons-pool2-2.11.1.jar at spark://192.168.40.128:35647/jars/org.apache.commons_commons-pool2-2.11.1.jar with timestamp 1764242498055
25/11/27 14:51:38 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar at spark://192.168.40.128:35647/jars/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar with timestamp 1764242498055
25/11/27 14:51:38 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/org.lz4_lz4-java-1.8.0.jar at spark://192.168.40.128:35647/jars/org.lz4_lz4-java-1.8.0.jar with timestamp 1764242498055
25/11/27 14:51:38 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/org.xerial.snappy_snappy-java-1.1.10.3.jar at spark://192.168.40.128:35647/jars/org.xerial.snappy_snappy-java-1.1.10.3.jar with timestamp 1764242498055
25/11/27 14:51:38 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/org.slf4j_slf4j-api-2.0.7.jar at spark://192.168.40.128:35647/jars/org.slf4j_slf4j-api-2.0.7.jar with timestamp 1764242498055
25/11/27 14:51:38 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-api-3.3.4.jar at spark://192.168.40.128:35647/jars/org.apache.hadoop_hadoop-client-api-3.3.4.jar with timestamp 1764242498055
25/11/27 14:51:38 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/commons-logging_commons-logging-1.1.3.jar at spark://192.168.40.128:35647/jars/commons-logging_commons-logging-1.1.3.jar with timestamp 1764242498055
25/11/27 14:51:38 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar at file:///home/alireza/.ivy2/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar with timestamp 1764242498055
25/11/27 14:51:38 INFO Utils: Copying /home/alireza/.ivy2/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar
25/11/27 14:51:38 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar at file:///home/alireza/.ivy2/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar with timestamp 1764242498055
25/11/27 14:51:38 INFO Utils: Copying /home/alireza/.ivy2/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar
25/11/27 14:51:38 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/org.apache.kafka_kafka-clients-3.4.1.jar at file:///home/alireza/.ivy2/jars/org.apache.kafka_kafka-clients-3.4.1.jar with timestamp 1764242498055
25/11/27 14:51:38 INFO Utils: Copying /home/alireza/.ivy2/jars/org.apache.kafka_kafka-clients-3.4.1.jar to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.apache.kafka_kafka-clients-3.4.1.jar
25/11/27 14:51:38 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/com.google.code.findbugs_jsr305-3.0.0.jar at file:///home/alireza/.ivy2/jars/com.google.code.findbugs_jsr305-3.0.0.jar with timestamp 1764242498055
25/11/27 14:51:38 INFO Utils: Copying /home/alireza/.ivy2/jars/com.google.code.findbugs_jsr305-3.0.0.jar to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/com.google.code.findbugs_jsr305-3.0.0.jar
25/11/27 14:51:38 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/org.apache.commons_commons-pool2-2.11.1.jar at file:///home/alireza/.ivy2/jars/org.apache.commons_commons-pool2-2.11.1.jar with timestamp 1764242498055
25/11/27 14:51:38 INFO Utils: Copying /home/alireza/.ivy2/jars/org.apache.commons_commons-pool2-2.11.1.jar to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.apache.commons_commons-pool2-2.11.1.jar
25/11/27 14:51:38 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar at file:///home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar with timestamp 1764242498055
25/11/27 14:51:38 INFO Utils: Copying /home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar
25/11/27 14:51:38 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/org.lz4_lz4-java-1.8.0.jar at file:///home/alireza/.ivy2/jars/org.lz4_lz4-java-1.8.0.jar with timestamp 1764242498055
25/11/27 14:51:38 INFO Utils: Copying /home/alireza/.ivy2/jars/org.lz4_lz4-java-1.8.0.jar to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.lz4_lz4-java-1.8.0.jar
25/11/27 14:51:38 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/org.xerial.snappy_snappy-java-1.1.10.3.jar at file:///home/alireza/.ivy2/jars/org.xerial.snappy_snappy-java-1.1.10.3.jar with timestamp 1764242498055
25/11/27 14:51:38 INFO Utils: Copying /home/alireza/.ivy2/jars/org.xerial.snappy_snappy-java-1.1.10.3.jar to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.xerial.snappy_snappy-java-1.1.10.3.jar
25/11/27 14:51:38 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/org.slf4j_slf4j-api-2.0.7.jar at file:///home/alireza/.ivy2/jars/org.slf4j_slf4j-api-2.0.7.jar with timestamp 1764242498055
25/11/27 14:51:38 INFO Utils: Copying /home/alireza/.ivy2/jars/org.slf4j_slf4j-api-2.0.7.jar to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.slf4j_slf4j-api-2.0.7.jar
25/11/27 14:51:38 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-api-3.3.4.jar at file:///home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-api-3.3.4.jar with timestamp 1764242498055
25/11/27 14:51:38 INFO Utils: Copying /home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-api-3.3.4.jar to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.apache.hadoop_hadoop-client-api-3.3.4.jar
25/11/27 14:51:38 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/commons-logging_commons-logging-1.1.3.jar at file:///home/alireza/.ivy2/jars/commons-logging_commons-logging-1.1.3.jar with timestamp 1764242498055
25/11/27 14:51:38 INFO Utils: Copying /home/alireza/.ivy2/jars/commons-logging_commons-logging-1.1.3.jar to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/commons-logging_commons-logging-1.1.3.jar
25/11/27 14:51:38 INFO Executor: Starting executor ID driver on host 192.168.40.128
25/11/27 14:51:38 INFO Executor: OS info Linux, 6.14.0-36-generic, amd64
25/11/27 14:51:38 INFO Executor: Java version 21.0.9
25/11/27 14:51:38 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
25/11/27 14:51:38 INFO Executor: Created or updated repl class loader org.apache.spark.util.MutableURLClassLoader@26c773da for default.
25/11/27 14:51:38 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar with timestamp 1764242498055
25/11/27 14:51:38 INFO Utils: /home/alireza/.ivy2/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar has been previously copied to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar
25/11/27 14:51:38 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/org.apache.kafka_kafka-clients-3.4.1.jar with timestamp 1764242498055
25/11/27 14:51:38 INFO Utils: /home/alireza/.ivy2/jars/org.apache.kafka_kafka-clients-3.4.1.jar has been previously copied to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.apache.kafka_kafka-clients-3.4.1.jar
25/11/27 14:51:38 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar with timestamp 1764242498055
25/11/27 14:51:39 INFO Utils: /home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar has been previously copied to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar
25/11/27 14:51:39 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar with timestamp 1764242498055
25/11/27 14:51:39 INFO Utils: /home/alireza/.ivy2/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar has been previously copied to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar
25/11/27 14:51:39 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/org.slf4j_slf4j-api-2.0.7.jar with timestamp 1764242498055
25/11/27 14:51:39 INFO Utils: /home/alireza/.ivy2/jars/org.slf4j_slf4j-api-2.0.7.jar has been previously copied to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.slf4j_slf4j-api-2.0.7.jar
25/11/27 14:51:39 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/org.xerial.snappy_snappy-java-1.1.10.3.jar with timestamp 1764242498055
25/11/27 14:51:39 INFO Utils: /home/alireza/.ivy2/jars/org.xerial.snappy_snappy-java-1.1.10.3.jar has been previously copied to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.xerial.snappy_snappy-java-1.1.10.3.jar
25/11/27 14:51:39 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/commons-logging_commons-logging-1.1.3.jar with timestamp 1764242498055
25/11/27 14:51:39 INFO Utils: /home/alireza/.ivy2/jars/commons-logging_commons-logging-1.1.3.jar has been previously copied to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/commons-logging_commons-logging-1.1.3.jar
25/11/27 14:51:39 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/com.google.code.findbugs_jsr305-3.0.0.jar with timestamp 1764242498055
25/11/27 14:51:39 INFO Utils: /home/alireza/.ivy2/jars/com.google.code.findbugs_jsr305-3.0.0.jar has been previously copied to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/com.google.code.findbugs_jsr305-3.0.0.jar
25/11/27 14:51:39 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/org.apache.commons_commons-pool2-2.11.1.jar with timestamp 1764242498055
25/11/27 14:51:39 INFO Utils: /home/alireza/.ivy2/jars/org.apache.commons_commons-pool2-2.11.1.jar has been previously copied to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.apache.commons_commons-pool2-2.11.1.jar
25/11/27 14:51:39 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-api-3.3.4.jar with timestamp 1764242498055
25/11/27 14:51:39 INFO Utils: /home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-api-3.3.4.jar has been previously copied to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.apache.hadoop_hadoop-client-api-3.3.4.jar
25/11/27 14:51:39 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/org.lz4_lz4-java-1.8.0.jar with timestamp 1764242498055
25/11/27 14:51:39 INFO Utils: /home/alireza/.ivy2/jars/org.lz4_lz4-java-1.8.0.jar has been previously copied to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.lz4_lz4-java-1.8.0.jar
25/11/27 14:51:39 INFO Executor: Fetching spark://192.168.40.128:35647/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar with timestamp 1764242498055
25/11/27 14:51:39 INFO TransportClientFactory: Successfully created connection to /192.168.40.128:35647 after 20 ms (0 ms spent in bootstraps)
25/11/27 14:51:39 INFO Utils: Fetching spark://192.168.40.128:35647/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/fetchFileTemp3115792845233187343.tmp
25/11/27 14:51:39 INFO Utils: /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/fetchFileTemp3115792845233187343.tmp has been previously copied to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar
25/11/27 14:51:39 INFO Executor: Adding file:/tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar to class loader default
25/11/27 14:51:39 INFO Executor: Fetching spark://192.168.40.128:35647/jars/org.slf4j_slf4j-api-2.0.7.jar with timestamp 1764242498055
25/11/27 14:51:39 INFO Utils: Fetching spark://192.168.40.128:35647/jars/org.slf4j_slf4j-api-2.0.7.jar to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/fetchFileTemp1358958307308361827.tmp
25/11/27 14:51:39 INFO Utils: /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/fetchFileTemp1358958307308361827.tmp has been previously copied to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.slf4j_slf4j-api-2.0.7.jar
25/11/27 14:51:39 INFO Executor: Adding file:/tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.slf4j_slf4j-api-2.0.7.jar to class loader default
25/11/27 14:51:39 INFO Executor: Fetching spark://192.168.40.128:35647/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar with timestamp 1764242498055
25/11/27 14:51:39 INFO Utils: Fetching spark://192.168.40.128:35647/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/fetchFileTemp18265958292405415669.tmp
25/11/27 14:51:39 INFO Utils: /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/fetchFileTemp18265958292405415669.tmp has been previously copied to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar
25/11/27 14:51:39 INFO Executor: Adding file:/tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar to class loader default
25/11/27 14:51:39 INFO Executor: Fetching spark://192.168.40.128:35647/jars/org.apache.commons_commons-pool2-2.11.1.jar with timestamp 1764242498055
25/11/27 14:51:39 INFO Utils: Fetching spark://192.168.40.128:35647/jars/org.apache.commons_commons-pool2-2.11.1.jar to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/fetchFileTemp489413334579726287.tmp
25/11/27 14:51:39 INFO Utils: /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/fetchFileTemp489413334579726287.tmp has been previously copied to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.apache.commons_commons-pool2-2.11.1.jar
25/11/27 14:51:39 INFO Executor: Adding file:/tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.apache.commons_commons-pool2-2.11.1.jar to class loader default
25/11/27 14:51:39 INFO Executor: Fetching spark://192.168.40.128:35647/jars/org.apache.kafka_kafka-clients-3.4.1.jar with timestamp 1764242498055
25/11/27 14:51:39 INFO Utils: Fetching spark://192.168.40.128:35647/jars/org.apache.kafka_kafka-clients-3.4.1.jar to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/fetchFileTemp428373081193179110.tmp
25/11/27 14:51:39 INFO Utils: /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/fetchFileTemp428373081193179110.tmp has been previously copied to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.apache.kafka_kafka-clients-3.4.1.jar
25/11/27 14:51:39 INFO Executor: Adding file:/tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.apache.kafka_kafka-clients-3.4.1.jar to class loader default
25/11/27 14:51:39 INFO Executor: Fetching spark://192.168.40.128:35647/jars/commons-logging_commons-logging-1.1.3.jar with timestamp 1764242498055
25/11/27 14:51:39 INFO Utils: Fetching spark://192.168.40.128:35647/jars/commons-logging_commons-logging-1.1.3.jar to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/fetchFileTemp6527086832236770402.tmp
25/11/27 14:51:39 INFO Utils: /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/fetchFileTemp6527086832236770402.tmp has been previously copied to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/commons-logging_commons-logging-1.1.3.jar
25/11/27 14:51:39 INFO Executor: Adding file:/tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/commons-logging_commons-logging-1.1.3.jar to class loader default
25/11/27 14:51:39 INFO Executor: Fetching spark://192.168.40.128:35647/jars/com.google.code.findbugs_jsr305-3.0.0.jar with timestamp 1764242498055
25/11/27 14:51:39 INFO Utils: Fetching spark://192.168.40.128:35647/jars/com.google.code.findbugs_jsr305-3.0.0.jar to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/fetchFileTemp14447687764610304018.tmp
25/11/27 14:51:39 INFO Utils: /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/fetchFileTemp14447687764610304018.tmp has been previously copied to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/com.google.code.findbugs_jsr305-3.0.0.jar
25/11/27 14:51:39 INFO Executor: Adding file:/tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/com.google.code.findbugs_jsr305-3.0.0.jar to class loader default
25/11/27 14:51:39 INFO Executor: Fetching spark://192.168.40.128:35647/jars/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar with timestamp 1764242498055
25/11/27 14:51:39 INFO Utils: Fetching spark://192.168.40.128:35647/jars/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/fetchFileTemp7811355606684863877.tmp
25/11/27 14:51:39 INFO Utils: /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/fetchFileTemp7811355606684863877.tmp has been previously copied to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar
25/11/27 14:51:39 INFO Executor: Adding file:/tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar to class loader default
25/11/27 14:51:39 INFO Executor: Fetching spark://192.168.40.128:35647/jars/org.apache.hadoop_hadoop-client-api-3.3.4.jar with timestamp 1764242498055
25/11/27 14:51:39 INFO Utils: Fetching spark://192.168.40.128:35647/jars/org.apache.hadoop_hadoop-client-api-3.3.4.jar to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/fetchFileTemp6698040436071389408.tmp
25/11/27 14:51:39 INFO Utils: /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/fetchFileTemp6698040436071389408.tmp has been previously copied to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.apache.hadoop_hadoop-client-api-3.3.4.jar
25/11/27 14:51:39 INFO Executor: Adding file:/tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.apache.hadoop_hadoop-client-api-3.3.4.jar to class loader default
25/11/27 14:51:39 INFO Executor: Fetching spark://192.168.40.128:35647/jars/org.xerial.snappy_snappy-java-1.1.10.3.jar with timestamp 1764242498055
25/11/27 14:51:39 INFO Utils: Fetching spark://192.168.40.128:35647/jars/org.xerial.snappy_snappy-java-1.1.10.3.jar to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/fetchFileTemp13438120508513933846.tmp
25/11/27 14:51:39 INFO Utils: /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/fetchFileTemp13438120508513933846.tmp has been previously copied to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.xerial.snappy_snappy-java-1.1.10.3.jar
25/11/27 14:51:39 INFO Executor: Adding file:/tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.xerial.snappy_snappy-java-1.1.10.3.jar to class loader default
25/11/27 14:51:39 INFO Executor: Fetching spark://192.168.40.128:35647/jars/org.lz4_lz4-java-1.8.0.jar with timestamp 1764242498055
25/11/27 14:51:39 INFO Utils: Fetching spark://192.168.40.128:35647/jars/org.lz4_lz4-java-1.8.0.jar to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/fetchFileTemp2082916728879396907.tmp
25/11/27 14:51:39 INFO Utils: /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/fetchFileTemp2082916728879396907.tmp has been previously copied to /tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.lz4_lz4-java-1.8.0.jar
25/11/27 14:51:39 INFO Executor: Adding file:/tmp/spark-2cbd57fa-e6ed-4fe3-b8c2-521fe5f8c9b6/userFiles-87581f80-1bc9-41bf-bcda-34c8d017d39f/org.lz4_lz4-java-1.8.0.jar to class loader default
25/11/27 14:51:39 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 32803.
25/11/27 14:51:39 INFO NettyBlockTransferService: Server created on 192.168.40.128:32803
25/11/27 14:51:39 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
25/11/27 14:51:39 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 192.168.40.128, 32803, None)
25/11/27 14:51:39 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.40.128:32803 with 434.4 MiB RAM, BlockManagerId(driver, 192.168.40.128, 32803, None)
25/11/27 14:51:39 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 192.168.40.128, 32803, None)
25/11/27 14:51:39 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, 192.168.40.128, 32803, None)
============================================================
Spark Session created
============================================================

Connecting to Kafka...
Kafka connection successful
Data transformation completed

Writing clean data to Kafka topic: bank_transaction_clean
25/11/27 14:51:41 WARN ResolveWriteToStream: spark.sql.adaptive.enabled is not supported in streaming DataFrames/Datasets and will be disabled.
Writing invalid data to Kafka topic: bank_transaction_invalid
25/11/27 14:51:41 WARN ResolveWriteToStream: spark.sql.adaptive.enabled is not supported in streaming DataFrames/Datasets and will be disabled.
============================================================
Streaming started
============================================================

Data is being split to two topics:
1. bank_transaction_clean
2. bank_transaction_invalid
Press Ctrl+C to stop...

25/11/27 14:51:48 WARN GarbageCollectionMetrics: To enable non-built-in garbage collector(s) List(G1 Concurrent GC), users should configure it(them) to spark.eventLog.gcMetrics.youngGenerationGarbageCollectors or spark.eventLog.gcMetrics.oldGenerationGarbageCollectors
25/11/27 14:52:00 WARN AdminClientConfig: These configurations '[key.deserializer, value.deserializer, enable.auto.commit, max.poll.records, auto.offset.reset]' were supplied but are not used yet.
25/11/27 14:52:00 WARN AdminClientConfig: These configurations '[key.deserializer, value.deserializer, enable.auto.commit, max.poll.records, auto.offset.reset]' were supplied but are not used yet.

#split on Kafka
989","transaction_type":"Withdrawal","amount":1961593.0,"currency":"IRR","txn_timestamp":"2024-06-18 07:52:11","txn_date":"2024-06-18","txn_hour":"07"}
{"transaction_id":"100000349457","customer_id":"ctid990026939","transaction_type":"Transfer","amount":2748132.0,"currency":"IRR","txn_timestamp":"2024-02-24 18:47:27","txn_date":"2024-02-24","txn_hour":"18"}
{"transaction_id":"100000473254","customer_id":"ctid151974016","transaction_type":"Withdrawal","amount":4.91562436E8,"currency":"IRR","txn_timestamp":"2024-12-24 20:38:00","txn_date":"2024-12-24","txn_hour":"20"}
{"transaction_id":"100000256840","customer_id":"ctid290071060","transaction_type":"Transfer","amount":2553385.0,"currency":"IRR","txn_timestamp":"2024-07-12 23:46:56","txn_date":"2024-07-12","txn_hour":"23"}
{"transaction_id":"100000489492","customer_id":"ctid210499059","transaction_type":"Transfer","amount":4253262.0,"currency":"IRR","txn_timestamp":"2024-09-27 11:01:39","txn_date":"2024-09-27","txn_hour":"11"}
{"transaction_id":"100000565894","customer_id":"ctid404669704","transaction_type":"Deposit","amount":4045958.0,"currency":"IRR","txn_timestamp":"2024-07-29 22:19:41","txn_date":"2024-07-29","txn_hour":"22"}
{"transaction_id":"100000528178","customer_id":"ctid427564108","transaction_type":"Transfer","amount":2177777.0,"currency":"IRR","txn_timestamp":"2024-04-04 01:04:22","txn_date":"2024-04-04","txn_hour":"01"}
{"transaction_id":"100000331236","customer_id":"ctid215241782","transaction_type":"Deposit","amount":4083246.0,"currency":"IRR","txn_timestamp":"2024-11-28 00:05:04","txn_date":"2024-11-28","txn_hour":"00"}
{"transaction_id":"100000273538","customer_id":"ctid859726637","transaction_type":"Transfer","amount":3817934.0,"currency":"IRR","txn_timestamp":"2024-01-26 16:33:54","txn_date":"2024-01-26","txn_hour":"16"}
{"transaction_id":"100000902648","customer_id":"ctid457951846","transaction_type":"Deposit","amount":1773209.0,"currency":"IRR","txn_timestamp":"2024-11-27 10:08:45","txn_date":"2024-11-27","txn_hour":"10"}
{"transaction_id":"100000555839","customer_id":"ctid769366889","transaction_type":"Withdrawal","amount":1407364.0,"currency":"IRR","txn_timestamp":"2024-02-21 22:02:13","txn_date":"2024-02-21","txn_hour":"22"}
{"transaction_id":"100000328947","customer_id":"ctid713345088","transaction_type":"Transfer","amount":2593544.0,"currency":"IRR","txn_timestamp":"2024-01-13 16:27:19","txn_date":"2024-01-13","txn_hour":"16"}
{"transaction_id":"100000319030","customer_id":"ctid324659965","transaction_type":"Transfer","amount":2782077.0,"currency":"IRR","txn_timestamp":"2024-10-12 10:48:38","txn_date":"2024-10-12","txn_hour":"10"}
{"transaction_id":"100000591723","customer_id":"ctid604152973","transaction_type":"Withdrawal","amount":1880589.0,"currency":"IRR","txn_timestamp":"2024-07-07 12:41:17","txn_date":"2024-07-07","txn_hour":"12"}
{"transaction_id":"100000905778","customer_id":"ctid856351697","transaction_type":"Deposit","amount":3882454.0,"currency":"IRR","txn_timestamp":"2024-12-25 00:22:11","txn_date":"2024-12-25","txn_hour":"00"}
{"transaction_id":"100000953277","customer_id":"ctid305189532","transaction_type":"Withdrawal","amount":4472744.0,"currency":"IRR","txn_timestamp":"2024-09-16 02:13:26","txn_date":"2024-09-16","txn_hour":"02"}
{"transaction_id":"100000084654","customer_id":"ctid510120396","transaction_type":"Transfer","amount":4248142.0,"currency":"IRR","txn_timestamp":"2024-09-05 14:45:41","txn_date":"2024-09-05","txn_hour":"14"}
{"transaction_id":"100000129981","customer_id":"ctid422402594","transaction_type":"Withdrawal","amount":4668761.0,"currency":"IRR","txn_timestamp":"2024-03-21 15:41:25","txn_date":"2024-03-21","txn_hour":"15"}
{"transaction_id":"100000065725","customer_id":"ctid655758387","transaction_type":"Withdrawal","amount":1263046.0,"currency":"IRR","txn_timestamp":"2024-12-08 18:31:17","txn_date":"2024-12-08","txn_hour":"18"}
{"transaction_id":"100000452366","customer_id":"ctid935383707","transaction_type":"Transfer","amount":3497281.0,"currency":"IRR","txn_timestamp":"2024-02-09 09:07:26","txn_date":"2024-02-09","txn_hour":"09"}
{"transaction_id":"100000648143","customer_id":"ctid235264897","transaction_type":"Transfer","amount":2230883.0,"currency":"IRR","txn_timestamp":"2024-12-20 04:36:33","txn_date":"2024-12-20","txn_hour":"04"}
{"transaction_id":"100000527035","customer_id":"ctid859875954","transaction_type":"Transfer","amount":4093346.0,"currency":"IRR","txn_timestamp":"2024-01-22 07:08:28","txn_date":"2024-01-22","txn_hour":"07"}
{"transaction_id":"100000654811","customer_id":"ctid644074055","transaction_type":"Transfer","amount":231787.0,"currency":"IRR","txn_timestamp":"2024-08-24 13:43:42","txn_date":"2024-08-24","txn_hour":"13"}
{"transaction_id":"100000149503","customer_id":"ctid494056989","transaction_type":"Transfer","amount":8.19863862E8,"currency":"IRR","txn_timestamp":"2024-01-13 11:57:07","txn_date":"2024-01-13","txn_hour":"11"}
{"transaction_id":"100000384681","customer_id":"ctid200279978","transaction_type":"Deposit","amount":4994274.0,"currency":"IRR","txn_timestamp":"2024-02-09 05:14:30","txn_date":"2024-02-09","txn_hour":"05"}
{"transaction_id":"100000870910","customer_id":"ctid265571775","transaction_type":"Transfer","amount":355132.0,"currency":"IRR","txn_timestamp":"2024-03-28 02:36:57","txn_date":"2024-03-28","txn_hour":"02"}
{"transaction_id":"100000156730","customer_id":"ctid602015627","transaction_type":"Deposit","amount":1579132.0,"currency":"IRR","txn_timestamp":"2024-04-07 20:45:01","txn_date":"2024-04-07","txn_hour":"20"}
{"transaction_id":"100000500186","customer_id":"ctid718304920","transaction_type":"Transfer","amount":2965681.0,"currency":"IRR","txn_timestamp":"2024-11-22 05:09:02","txn_date":"2024-11-22","txn_hour":"05"}
{"transaction_id":"100000917040","customer_id":"ctid376226228","transaction_type":"Withdrawal","amount":4584998.0,"currency":"IRR","txn_timestamp":"2024-03-14 21:36:39","txn_date":"2024-03-14","txn_hour":"21"}
{"transaction_id":"100000486232","customer_id":"ctid724931575","transaction_type":"Transfer","amount":4218542.0,"currency":"IRR","txn_timestamp":"2024-05-24 12:45:34","txn_date":"2024-05-24","txn_hour":"12"}
{"transaction_id":"100000258795","customer_id":"ctid935353840","transaction_type":"Transfer","amount":1938226.0,"currency":"IRR","txn_timestamp":"2024-05-14 18:35:07","txn_date":"2024-05-14","txn_hour":"18"}
{"transaction_id":"100000989436","customer_id":"ctid171090612","transaction_type":"Transfer","amount":3170753.0,"currency":"IRR","txn_timestamp":"2024-12-22 23:50:37","txn_date":"2024-12-22","txn_hour":"23"}
{"transaction_id":"100000421909","customer_id":"ctid129772944","transaction_type":"Transfer","amount":1449647.0,"currency":"IRR","txn_timestamp":"2024-02-06 15:56:42","txn_date":"2024-02-06","txn_hour":"15"}
{"transaction_id":"100000347449","customer_id":"ctid727617369","transaction_type":"Transfer","amount":1792940.0,"currency":"IRR","txn_timestamp":"2024-06-11 18:53:49","txn_date":"2024-06-11","txn_hour":"18"}
{"transaction_id":"100000184779","customer_id":"ctid679255809","transaction_type":"Transfer","amount":2951726.0,"currency":"IRR","txn_timestamp":"2024-09-12 11:03:04","txn_date":"2024-09-12","txn_hour":"11"}
{"transaction_id":"100000214176","customer_id":"ctid705878784","transaction_type":"Withdrawal","amount":987057.0,"currency":"IRR","txn_timestamp":"2024-01-10 10:44:30","txn_date":"2024-01-10","txn_hour":"10"}
{"transaction_id":"100000235796","customer_id":"ctid827698083","transaction_type":"Withdrawal","amount":1423479.0,"currency":"IRR","txn_timestamp":"2024-08-14 16:41:02","txn_date":"2024-08-14","txn_hour":"16"}
{"transaction_id":"100000103355","customer_id":"ctid993311581","transaction_type":"Transfer","amount":285607.0,"currency":"IRR","txn_timestamp":"2024-07-11 19:43:56","txn_date":"2024-07-11","txn_hour":"19"}
{"transaction_id":"100000791743","customer_id":"ctid726230925","transaction_type":"Transfer","amount":531266.0,"currency":"IRR","txn_timestamp":"2024-09-01 13:01:30","txn_date":"2024-09-01","txn_hour":"13"}
{"transaction_id":"100000199041","customer_id":"ctid695082843","transaction_type":"Transfer","amount":3345127.0,"currency":"IRR","txn_timestamp":"2024-12-27 16:57:03","txn_date":"2024-12-27","txn_hour":"16"}
{"transaction_id":"100000776997","customer_id":"ctid417489960","transaction_type":"Withdrawal","amount":319884.0,"currency":"IRR","txn_timestamp":"2024-10-05 15:07:35","txn_date":"2024-10-05","txn_hour":"15"}
{"transaction_id":"100000327069","customer_id":"ctid351907444","transaction_type":"Transfer","amount":3212782.0,"currency":"IRR","txn_timestamp":"2024-11-29 14:08:36","txn_date":"2024-11-29","txn_hour":"14"}
{"transaction_id":"100000718315","customer_id":"ctid333031290","transaction_type":"Deposit","amount":2475407.0,"currency":"IRR","txn_timestamp":"2024-07-29 05:39:17","txn_date":"2024-07-29","txn_hour":"05"}
{"transaction_id":"100000321879","customer_id":"ctid751302422","transaction_type":"Withdrawal","amount":449460.0,"currency":"IRR","txn_timestamp":"2024-06-25 04:36:17","txn_date":"2024-06-25","txn_hour":"04"}
{"transaction_id":"100000787201","customer_id":"ctid759537790","transaction_type":"Withdrawal","amount":4858597.0,"currency":"IRR","txn_timestamp":"2024-06-25 20:38:12","txn_date":"2024-06-25","txn_hour":"20"}
{"transaction_id":"100000064820","customer_id":"ctid746650272","transaction_type":"Withdrawal","amount":936372.0,"currency":"IRR","txn_timestamp":"2024-11-08 11:31:07","txn_date":"2024-11-08","txn_hour":"11"}
{"transaction_id":"100000329365","customer_id":"ctid958352125","transaction_type":"Withdrawal","amount":4855014.0,"currency":"IRR","txn_timestamp":"2024-07-04 04:39:12","txn_date":"2024-07-04","txn_hour":"04"}
{"transaction_id":"100000041090","customer_id":"ctid226313039","transaction_type":"Deposit","amount":3916039.0,"currency":"IRR","txn_timestamp":"2024-08-11 16:34:36","txn_date":"2024-08-11","txn_hour":"16"}
{"transaction_id":"100000278167","customer_id":"ctid162049137","transaction_type":"Transfer","amount":1950473.0,"currency":"IRR","txn_timestamp":"2024-03-21 11:15:13","txn_date":"2024-03-21","txn_hour":"11"}
{"transaction_id":"100000191335","customer_id":"ctid214271273","transaction_type":"Deposit","amount":1437960.0,"currency":"IRR","txn_timestamp":"2024-04-17 08:21:01","txn_date":"2024-04-17","txn_hour":"08"}
{"transaction_id":"100000175203","customer_id":"ctid337985080","transaction_type":"Transfer","amount":3763290.0,"currency":"IRR","txn_timestamp":"2024-06-06 12:02:29","txn_date":"2024-06-06","txn_hour":"12"}
{"transaction_id":"100000912756","customer_id":"ctid279713916","transaction_type":"Withdrawal","amount":1621661.0,"currency":"IRR","txn_timestamp":"2024-03-28 00:29:23","txn_date":"2024-03-28","txn_hour":"00"}
{"transaction_id":"100000899159","customer_id":"ctid545890964","transaction_type":"Withdrawal","amount":536277.0,"currency":"IRR","txn_timestamp":"2024-12-02 00:51:25","txn_date":"2024-12-02","txn_hour":"00"}
{"transaction_id":"100000087498","customer_id":"ctid544976023","transaction_type":"Withdrawal","amount":4726137.0,"currency":"IRR","txn_timestamp":"2024-05-06 11:42:01","txn_date":"2024-05-06","txn_hour":"11"}
{"transaction_id":"100000954698","customer_id":"ctid996547764","transaction_type":"Withdrawal","amount":2182506.0,"currency":"IRR","txn_timestamp":"2024-01-07 03:58:20","txn_date":"2024-01-07","txn_hour":"03"}
{"transaction_id":"100000521430","customer_id":"ctid229990128","transaction_type":"Withdrawal","amount":3893303.0,"currency":"IRR","txn_timestamp":"2024-11-15 12:05:01","txn_date":"2024-11-15","txn_hour":"12"}
{"transaction_id":"100000999890","customer_id":"ctid376730256","transaction_type":"Transfer","amount":3811238.0,"currency":"IRR","txn_timestamp":"2024-07-30 11:01:14","txn_date":"2024-07-30","txn_hour":"11"}
{"transaction_id":"100000137337","customer_id":"ctid390798162","transaction_type":"Transfer","amount":380181.0,"currency":"IRR","txn_timestamp":"2024-11-04 23:45:06","txn_date":"2024-11-04","txn_hour":"23"}
{"transaction_id":"100000054886","customer_id":"ctid704509787","transaction_type":"Withdrawal","amount":1584522.0,"currency":"IRR","txn_timestamp":"2024-06-26 16:37:18","txn_date":"2024-06-26","txn_hour":"16"}
{"transaction_id":"100000732180","customer_id":"ctid996098961","transaction_type":"Deposit","amount":1526381.0,"currency":"IRR","txn_timestamp":"2024-12-09 15:53:36","txn_date":"2024-12-09","txn_hour":"15"}
{"transaction_id":"100000110268","customer_id":"ctid187296858","transaction_type":"Deposit","amount":3505004.0,"currency":"IRR","txn_timestamp":"2024-05-23 21:49:39","txn_date":"2024-05-23","txn_hour":"21"}
{"transaction_id":"100000644167","customer_id":"ctid603192960","transaction_type":"Deposit","amount":4548167.0,"currency":"IRR","txn_timestamp":"2024-11-20 13:27:15","txn_date":"2024-11-20","txn_hour":"13"}
{"transaction_id":"100000259178","customer_id":"ctid495989341","transaction_type":"Deposit","amount":2432161.0,"currency":"IRR","txn_timestamp":"2024-07-03 00:59:27","txn_date":"2024-07-03","txn_hour":"00"}
{"transaction_id":"100000365838","customer_id":"ctid630597290","transaction_type":"Transfer","amount":131276.0,"currency":"IRR","txn_timestamp":"2024-11-13 07:48:09","txn_date":"2024-11-13","txn_hour":"07"}
{"transaction_id":"100000131932","customer_id":"ctid566629823","transaction_type":"Deposit","amount":2.39227719E8,"currency":"IRR","txn_timestamp":"2024-08-23 17:14:47","txn_date":"2024-08-23","txn_hour":"17"}
{"transaction_id":"100000671155","customer_id":"ctid160590965","transaction_type":"Withdrawal","amount":3175965.0,"currency":"IRR","txn_timestamp":"2024-01-10 18:38:57","txn_date":"2024-01-10","txn_hour":"18"}
{"transaction_id":"100000121958","customer_id":"ctid173729400","transaction_type":"Transfer","amount":365509.0,"currency":"IRR","txn_timestamp":"2024-06-16 10:37:19","txn_date":"2024-06-16","txn_hour":"10"}
^CProcessed a total of 981074 messages
[appuser@kafka ~]$ kafka-console-consumer --topic bank_transaction_invalid --from-beginning --bootstrap-server kafka:9092 

#run script for insert on hdfs and 
(env) alireza@alireza-VMware-Virtual-Platform:~/projects/project3/01-rev$ spark-submit   --master local[*]   --packages org.apache.spark:spark-sql-kafka-0-10_2.12:3.5.1,com.clickhouse:clickhouse-jdbc:0.4.6   kafka_fraud_detection.py
25/11/27 15:41:25 WARN Utils: Your hostname, alireza-VMware-Virtual-Platform resolves to a loopback address: 127.0.1.1; using 192.168.40.128 instead (on interface ens33)
25/11/27 15:41:25 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
:: loading settings :: url = jar:file:/home/alireza/projects/project3/01-rev/env/lib/python3.12/site-packages/pyspark/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
Ivy Default Cache set to: /home/alireza/.ivy2/cache
The jars for the packages stored in: /home/alireza/.ivy2/jars
org.apache.spark#spark-sql-kafka-0-10_2.12 added as a dependency
com.clickhouse#clickhouse-jdbc added as a dependency
:: resolving dependencies :: org.apache.spark#spark-submit-parent-8d9426e3-1f7c-4e4f-80c3-b3a38db04d97;1.0
	confs: [default]
	found org.apache.spark#spark-sql-kafka-0-10_2.12;3.5.1 in central
	found org.apache.spark#spark-token-provider-kafka-0-10_2.12;3.5.1 in central
	found org.apache.kafka#kafka-clients;3.4.1 in central
	found org.lz4#lz4-java;1.8.0 in central
	found org.xerial.snappy#snappy-java;1.1.10.3 in central
	found org.slf4j#slf4j-api;2.0.7 in central
	found org.apache.hadoop#hadoop-client-runtime;3.3.4 in central
	found org.apache.hadoop#hadoop-client-api;3.3.4 in central
	found commons-logging#commons-logging;1.1.3 in central
	found com.google.code.findbugs#jsr305;3.0.0 in central
	found org.apache.commons#commons-pool2;2.11.1 in central
	found com.clickhouse#clickhouse-jdbc;0.4.6 in central
:: resolution report :: resolve 393ms :: artifacts dl 12ms
	:: modules in use:
	com.clickhouse#clickhouse-jdbc;0.4.6 from central in [default]
	com.google.code.findbugs#jsr305;3.0.0 from central in [default]
	commons-logging#commons-logging;1.1.3 from central in [default]
	org.apache.commons#commons-pool2;2.11.1 from central in [default]
	org.apache.hadoop#hadoop-client-api;3.3.4 from central in [default]
	org.apache.hadoop#hadoop-client-runtime;3.3.4 from central in [default]
	org.apache.kafka#kafka-clients;3.4.1 from central in [default]
	org.apache.spark#spark-sql-kafka-0-10_2.12;3.5.1 from central in [default]
	org.apache.spark#spark-token-provider-kafka-0-10_2.12;3.5.1 from central in [default]
	org.lz4#lz4-java;1.8.0 from central in [default]
	org.slf4j#slf4j-api;2.0.7 from central in [default]
	org.xerial.snappy#snappy-java;1.1.10.3 from central in [default]
	---------------------------------------------------------------------
	|                  |            modules            ||   artifacts   |
	|       conf       | number| search|dwnlded|evicted|| number|dwnlded|
	---------------------------------------------------------------------
	|      default     |   12  |   0   |   0   |   0   ||   12  |   0   |
	---------------------------------------------------------------------
:: retrieving :: org.apache.spark#spark-submit-parent-8d9426e3-1f7c-4e4f-80c3-b3a38db04d97
	confs: [default]
	0 artifacts copied, 12 already retrieved (0kB/9ms)
25/11/27 15:41:26 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
25/11/27 15:41:27 INFO SparkContext: Running Spark version 3.5.1
25/11/27 15:41:27 INFO SparkContext: OS info Linux, 6.14.0-36-generic, amd64
25/11/27 15:41:27 INFO SparkContext: Java version 21.0.9
25/11/27 15:41:27 INFO ResourceUtils: ==============================================================
25/11/27 15:41:27 INFO ResourceUtils: No custom resources configured for spark.driver.
25/11/27 15:41:27 INFO ResourceUtils: ==============================================================
25/11/27 15:41:27 INFO SparkContext: Submitted application: FraudDetection
25/11/27 15:41:27 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
25/11/27 15:41:27 INFO ResourceProfile: Limiting resource is cpu
25/11/27 15:41:27 INFO ResourceProfileManager: Added ResourceProfile id: 0
25/11/27 15:41:27 INFO SecurityManager: Changing view acls to: alireza
25/11/27 15:41:27 INFO SecurityManager: Changing modify acls to: alireza
25/11/27 15:41:27 INFO SecurityManager: Changing view acls groups to: 
25/11/27 15:41:27 INFO SecurityManager: Changing modify acls groups to: 
25/11/27 15:41:27 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: alireza; groups with view permissions: EMPTY; users with modify permissions: alireza; groups with modify permissions: EMPTY
25/11/27 15:41:27 INFO Utils: Successfully started service 'sparkDriver' on port 41287.
25/11/27 15:41:27 INFO SparkEnv: Registering MapOutputTracker
25/11/27 15:41:28 INFO SparkEnv: Registering BlockManagerMaster
25/11/27 15:41:28 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
25/11/27 15:41:28 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
25/11/27 15:41:28 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
25/11/27 15:41:28 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-d67bb868-0aa4-42f4-b583-fbb609eee5f5
25/11/27 15:41:28 INFO MemoryStore: MemoryStore started with capacity 434.4 MiB
25/11/27 15:41:28 INFO SparkEnv: Registering OutputCommitCoordinator
25/11/27 15:41:28 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
25/11/27 15:41:28 WARN Utils: Service 'SparkUI' could not bind on port 4040. Attempting port 4041.
25/11/27 15:41:28 INFO Utils: Successfully started service 'SparkUI' on port 4041.
25/11/27 15:41:28 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar at spark://192.168.40.128:41287/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/com.clickhouse_clickhouse-jdbc-0.4.6.jar at spark://192.168.40.128:41287/jars/com.clickhouse_clickhouse-jdbc-0.4.6.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar at spark://192.168.40.128:41287/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/org.apache.kafka_kafka-clients-3.4.1.jar at spark://192.168.40.128:41287/jars/org.apache.kafka_kafka-clients-3.4.1.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/com.google.code.findbugs_jsr305-3.0.0.jar at spark://192.168.40.128:41287/jars/com.google.code.findbugs_jsr305-3.0.0.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/org.apache.commons_commons-pool2-2.11.1.jar at spark://192.168.40.128:41287/jars/org.apache.commons_commons-pool2-2.11.1.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar at spark://192.168.40.128:41287/jars/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/org.lz4_lz4-java-1.8.0.jar at spark://192.168.40.128:41287/jars/org.lz4_lz4-java-1.8.0.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/org.xerial.snappy_snappy-java-1.1.10.3.jar at spark://192.168.40.128:41287/jars/org.xerial.snappy_snappy-java-1.1.10.3.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/org.slf4j_slf4j-api-2.0.7.jar at spark://192.168.40.128:41287/jars/org.slf4j_slf4j-api-2.0.7.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-api-3.3.4.jar at spark://192.168.40.128:41287/jars/org.apache.hadoop_hadoop-client-api-3.3.4.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO SparkContext: Added JAR file:///home/alireza/.ivy2/jars/commons-logging_commons-logging-1.1.3.jar at spark://192.168.40.128:41287/jars/commons-logging_commons-logging-1.1.3.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar at file:///home/alireza/.ivy2/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: Copying /home/alireza/.ivy2/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar
25/11/27 15:41:28 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/com.clickhouse_clickhouse-jdbc-0.4.6.jar at file:///home/alireza/.ivy2/jars/com.clickhouse_clickhouse-jdbc-0.4.6.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: Copying /home/alireza/.ivy2/jars/com.clickhouse_clickhouse-jdbc-0.4.6.jar to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/com.clickhouse_clickhouse-jdbc-0.4.6.jar
25/11/27 15:41:28 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar at file:///home/alireza/.ivy2/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: Copying /home/alireza/.ivy2/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar
25/11/27 15:41:28 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/org.apache.kafka_kafka-clients-3.4.1.jar at file:///home/alireza/.ivy2/jars/org.apache.kafka_kafka-clients-3.4.1.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: Copying /home/alireza/.ivy2/jars/org.apache.kafka_kafka-clients-3.4.1.jar to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.apache.kafka_kafka-clients-3.4.1.jar
25/11/27 15:41:28 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/com.google.code.findbugs_jsr305-3.0.0.jar at file:///home/alireza/.ivy2/jars/com.google.code.findbugs_jsr305-3.0.0.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: Copying /home/alireza/.ivy2/jars/com.google.code.findbugs_jsr305-3.0.0.jar to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/com.google.code.findbugs_jsr305-3.0.0.jar
25/11/27 15:41:28 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/org.apache.commons_commons-pool2-2.11.1.jar at file:///home/alireza/.ivy2/jars/org.apache.commons_commons-pool2-2.11.1.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: Copying /home/alireza/.ivy2/jars/org.apache.commons_commons-pool2-2.11.1.jar to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.apache.commons_commons-pool2-2.11.1.jar
25/11/27 15:41:28 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar at file:///home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: Copying /home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar
25/11/27 15:41:28 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/org.lz4_lz4-java-1.8.0.jar at file:///home/alireza/.ivy2/jars/org.lz4_lz4-java-1.8.0.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: Copying /home/alireza/.ivy2/jars/org.lz4_lz4-java-1.8.0.jar to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.lz4_lz4-java-1.8.0.jar
25/11/27 15:41:28 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/org.xerial.snappy_snappy-java-1.1.10.3.jar at file:///home/alireza/.ivy2/jars/org.xerial.snappy_snappy-java-1.1.10.3.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: Copying /home/alireza/.ivy2/jars/org.xerial.snappy_snappy-java-1.1.10.3.jar to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.xerial.snappy_snappy-java-1.1.10.3.jar
25/11/27 15:41:28 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/org.slf4j_slf4j-api-2.0.7.jar at file:///home/alireza/.ivy2/jars/org.slf4j_slf4j-api-2.0.7.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: Copying /home/alireza/.ivy2/jars/org.slf4j_slf4j-api-2.0.7.jar to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.slf4j_slf4j-api-2.0.7.jar
25/11/27 15:41:28 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-api-3.3.4.jar at file:///home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-api-3.3.4.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: Copying /home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-api-3.3.4.jar to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.apache.hadoop_hadoop-client-api-3.3.4.jar
25/11/27 15:41:28 INFO SparkContext: Added file file:///home/alireza/.ivy2/jars/commons-logging_commons-logging-1.1.3.jar at file:///home/alireza/.ivy2/jars/commons-logging_commons-logging-1.1.3.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: Copying /home/alireza/.ivy2/jars/commons-logging_commons-logging-1.1.3.jar to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/commons-logging_commons-logging-1.1.3.jar
25/11/27 15:41:28 INFO Executor: Starting executor ID driver on host 192.168.40.128
25/11/27 15:41:28 INFO Executor: OS info Linux, 6.14.0-36-generic, amd64
25/11/27 15:41:28 INFO Executor: Java version 21.0.9
25/11/27 15:41:28 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
25/11/27 15:41:28 INFO Executor: Created or updated repl class loader org.apache.spark.util.MutableURLClassLoader@4ad6844c for default.
25/11/27 15:41:28 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/com.clickhouse_clickhouse-jdbc-0.4.6.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: /home/alireza/.ivy2/jars/com.clickhouse_clickhouse-jdbc-0.4.6.jar has been previously copied to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/com.clickhouse_clickhouse-jdbc-0.4.6.jar
25/11/27 15:41:28 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: /home/alireza/.ivy2/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar has been previously copied to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar
25/11/27 15:41:28 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/org.apache.kafka_kafka-clients-3.4.1.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: /home/alireza/.ivy2/jars/org.apache.kafka_kafka-clients-3.4.1.jar has been previously copied to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.apache.kafka_kafka-clients-3.4.1.jar
25/11/27 15:41:28 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: /home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar has been previously copied to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar
25/11/27 15:41:28 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: /home/alireza/.ivy2/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar has been previously copied to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar
25/11/27 15:41:28 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/org.slf4j_slf4j-api-2.0.7.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: /home/alireza/.ivy2/jars/org.slf4j_slf4j-api-2.0.7.jar has been previously copied to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.slf4j_slf4j-api-2.0.7.jar
25/11/27 15:41:28 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/org.xerial.snappy_snappy-java-1.1.10.3.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: /home/alireza/.ivy2/jars/org.xerial.snappy_snappy-java-1.1.10.3.jar has been previously copied to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.xerial.snappy_snappy-java-1.1.10.3.jar
25/11/27 15:41:28 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/commons-logging_commons-logging-1.1.3.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: /home/alireza/.ivy2/jars/commons-logging_commons-logging-1.1.3.jar has been previously copied to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/commons-logging_commons-logging-1.1.3.jar
25/11/27 15:41:28 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/com.google.code.findbugs_jsr305-3.0.0.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: /home/alireza/.ivy2/jars/com.google.code.findbugs_jsr305-3.0.0.jar has been previously copied to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/com.google.code.findbugs_jsr305-3.0.0.jar
25/11/27 15:41:28 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/org.apache.commons_commons-pool2-2.11.1.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: /home/alireza/.ivy2/jars/org.apache.commons_commons-pool2-2.11.1.jar has been previously copied to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.apache.commons_commons-pool2-2.11.1.jar
25/11/27 15:41:28 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-api-3.3.4.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: /home/alireza/.ivy2/jars/org.apache.hadoop_hadoop-client-api-3.3.4.jar has been previously copied to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.apache.hadoop_hadoop-client-api-3.3.4.jar
25/11/27 15:41:28 INFO Executor: Fetching file:///home/alireza/.ivy2/jars/org.lz4_lz4-java-1.8.0.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: /home/alireza/.ivy2/jars/org.lz4_lz4-java-1.8.0.jar has been previously copied to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.lz4_lz4-java-1.8.0.jar
25/11/27 15:41:28 INFO Executor: Fetching spark://192.168.40.128:41287/jars/org.apache.commons_commons-pool2-2.11.1.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO TransportClientFactory: Successfully created connection to /192.168.40.128:41287 after 16 ms (0 ms spent in bootstraps)
25/11/27 15:41:28 INFO Utils: Fetching spark://192.168.40.128:41287/jars/org.apache.commons_commons-pool2-2.11.1.jar to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/fetchFileTemp17396577104358658033.tmp
25/11/27 15:41:28 INFO Utils: /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/fetchFileTemp17396577104358658033.tmp has been previously copied to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.apache.commons_commons-pool2-2.11.1.jar
25/11/27 15:41:28 INFO Executor: Adding file:/tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.apache.commons_commons-pool2-2.11.1.jar to class loader default
25/11/27 15:41:28 INFO Executor: Fetching spark://192.168.40.128:41287/jars/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: Fetching spark://192.168.40.128:41287/jars/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/fetchFileTemp2443193749502113663.tmp
25/11/27 15:41:28 INFO Utils: /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/fetchFileTemp2443193749502113663.tmp has been previously copied to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar
25/11/27 15:41:28 INFO Executor: Adding file:/tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.apache.hadoop_hadoop-client-runtime-3.3.4.jar to class loader default
25/11/27 15:41:28 INFO Executor: Fetching spark://192.168.40.128:41287/jars/com.clickhouse_clickhouse-jdbc-0.4.6.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: Fetching spark://192.168.40.128:41287/jars/com.clickhouse_clickhouse-jdbc-0.4.6.jar to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/fetchFileTemp15518260393194520491.tmp
25/11/27 15:41:28 INFO Utils: /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/fetchFileTemp15518260393194520491.tmp has been previously copied to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/com.clickhouse_clickhouse-jdbc-0.4.6.jar
25/11/27 15:41:28 INFO Executor: Adding file:/tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/com.clickhouse_clickhouse-jdbc-0.4.6.jar to class loader default
25/11/27 15:41:28 INFO Executor: Fetching spark://192.168.40.128:41287/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: Fetching spark://192.168.40.128:41287/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/fetchFileTemp3995815599793502294.tmp
25/11/27 15:41:28 INFO Utils: /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/fetchFileTemp3995815599793502294.tmp has been previously copied to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar
25/11/27 15:41:28 INFO Executor: Adding file:/tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.5.1.jar to class loader default
25/11/27 15:41:28 INFO Executor: Fetching spark://192.168.40.128:41287/jars/org.slf4j_slf4j-api-2.0.7.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: Fetching spark://192.168.40.128:41287/jars/org.slf4j_slf4j-api-2.0.7.jar to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/fetchFileTemp5281264621982007749.tmp
25/11/27 15:41:28 INFO Utils: /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/fetchFileTemp5281264621982007749.tmp has been previously copied to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.slf4j_slf4j-api-2.0.7.jar
25/11/27 15:41:28 INFO Executor: Adding file:/tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.slf4j_slf4j-api-2.0.7.jar to class loader default
25/11/27 15:41:28 INFO Executor: Fetching spark://192.168.40.128:41287/jars/commons-logging_commons-logging-1.1.3.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: Fetching spark://192.168.40.128:41287/jars/commons-logging_commons-logging-1.1.3.jar to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/fetchFileTemp1519681173562387061.tmp
25/11/27 15:41:28 INFO Utils: /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/fetchFileTemp1519681173562387061.tmp has been previously copied to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/commons-logging_commons-logging-1.1.3.jar
25/11/27 15:41:28 INFO Executor: Adding file:/tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/commons-logging_commons-logging-1.1.3.jar to class loader default
25/11/27 15:41:28 INFO Executor: Fetching spark://192.168.40.128:41287/jars/org.apache.hadoop_hadoop-client-api-3.3.4.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: Fetching spark://192.168.40.128:41287/jars/org.apache.hadoop_hadoop-client-api-3.3.4.jar to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/fetchFileTemp14818978684982387647.tmp
25/11/27 15:41:28 INFO Utils: /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/fetchFileTemp14818978684982387647.tmp has been previously copied to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.apache.hadoop_hadoop-client-api-3.3.4.jar
25/11/27 15:41:28 INFO Executor: Adding file:/tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.apache.hadoop_hadoop-client-api-3.3.4.jar to class loader default
25/11/27 15:41:28 INFO Executor: Fetching spark://192.168.40.128:41287/jars/org.apache.kafka_kafka-clients-3.4.1.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: Fetching spark://192.168.40.128:41287/jars/org.apache.kafka_kafka-clients-3.4.1.jar to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/fetchFileTemp2534689907774074552.tmp
25/11/27 15:41:28 INFO Utils: /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/fetchFileTemp2534689907774074552.tmp has been previously copied to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.apache.kafka_kafka-clients-3.4.1.jar
25/11/27 15:41:28 INFO Executor: Adding file:/tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.apache.kafka_kafka-clients-3.4.1.jar to class loader default
25/11/27 15:41:28 INFO Executor: Fetching spark://192.168.40.128:41287/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: Fetching spark://192.168.40.128:41287/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/fetchFileTemp17553085380985520825.tmp
25/11/27 15:41:28 INFO Utils: /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/fetchFileTemp17553085380985520825.tmp has been previously copied to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar
25/11/27 15:41:28 INFO Executor: Adding file:/tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.apache.spark_spark-sql-kafka-0-10_2.12-3.5.1.jar to class loader default
25/11/27 15:41:28 INFO Executor: Fetching spark://192.168.40.128:41287/jars/org.lz4_lz4-java-1.8.0.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: Fetching spark://192.168.40.128:41287/jars/org.lz4_lz4-java-1.8.0.jar to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/fetchFileTemp14337129737647694305.tmp
25/11/27 15:41:28 INFO Utils: /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/fetchFileTemp14337129737647694305.tmp has been previously copied to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.lz4_lz4-java-1.8.0.jar
25/11/27 15:41:28 INFO Executor: Adding file:/tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.lz4_lz4-java-1.8.0.jar to class loader default
25/11/27 15:41:28 INFO Executor: Fetching spark://192.168.40.128:41287/jars/com.google.code.findbugs_jsr305-3.0.0.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: Fetching spark://192.168.40.128:41287/jars/com.google.code.findbugs_jsr305-3.0.0.jar to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/fetchFileTemp4769227728914746874.tmp
25/11/27 15:41:28 INFO Utils: /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/fetchFileTemp4769227728914746874.tmp has been previously copied to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/com.google.code.findbugs_jsr305-3.0.0.jar
25/11/27 15:41:28 INFO Executor: Adding file:/tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/com.google.code.findbugs_jsr305-3.0.0.jar to class loader default
25/11/27 15:41:28 INFO Executor: Fetching spark://192.168.40.128:41287/jars/org.xerial.snappy_snappy-java-1.1.10.3.jar with timestamp 1764245487665
25/11/27 15:41:28 INFO Utils: Fetching spark://192.168.40.128:41287/jars/org.xerial.snappy_snappy-java-1.1.10.3.jar to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/fetchFileTemp16358955397670774082.tmp
25/11/27 15:41:28 INFO Utils: /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/fetchFileTemp16358955397670774082.tmp has been previously copied to /tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.xerial.snappy_snappy-java-1.1.10.3.jar
25/11/27 15:41:28 INFO Executor: Adding file:/tmp/spark-98823a5f-7401-42ae-9e02-01f85e0fbb04/userFiles-2e9fe199-beab-4a52-a1e9-64086dbbbe8e/org.xerial.snappy_snappy-java-1.1.10.3.jar to class loader default
25/11/27 15:41:28 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 46875.
25/11/27 15:41:28 INFO NettyBlockTransferService: Server created on 192.168.40.128:46875
25/11/27 15:41:28 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
25/11/27 15:41:28 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 192.168.40.128, 46875, None)
25/11/27 15:41:28 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.40.128:46875 with 434.4 MiB RAM, BlockManagerId(driver, 192.168.40.128, 46875, None)
25/11/27 15:41:28 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 192.168.40.128, 46875, None)
25/11/27 15:41:28 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, 192.168.40.128, 46875, None)
================================================================================
Spark Session created - Fraud Detection System Starting...
================================================================================

Starting stream for INVALID data → HDFS + Hive
25/11/27 15:41:30 WARN ResolveWriteToStream: spark.sql.adaptive.enabled is not supported in streaming DataFrames/Datasets and will be disabled.
Invalid data stream → HDFS started

Starting stream for CLEAN data → Fraud Detection → ClickHouse
25/11/27 15:41:31 WARN ResolveWriteToStream: Temporary checkpoint location created which is deleted normally when the query didn't fail: /tmp/temporary-a8085539-ac9d-4233-b810-400b43e5f27e. If it's required to delete it under any circumstances, please set spark.sql.streaming.forceDeleteTempCheckpointLocation to true. Important to know deleting temp checkpoint folder is best effort.
25/11/27 15:41:31 WARN ResolveWriteToStream: spark.sql.adaptive.enabled is not supported in streaming DataFrames/Datasets and will be disabled.
25/11/27 15:41:31 WARN AdminClientConfig: These configurations '[key.deserializer, value.deserializer, enable.auto.commit, max.poll.records, auto.offset.reset]' were supplied but are not used yet.
25/11/27 15:41:31 WARN ResolveWriteToStream: Temporary checkpoint location created which is deleted normally when the query didn't fail: /tmp/temporary-c37783aa-0269-4867-ba88-0c7cffc1e8ba. If it's required to delete it under any circumstances, please set spark.sql.streaming.forceDeleteTempCheckpointLocation to true. Important to know deleting temp checkpoint folder is best effort.
25/11/27 15:41:31 WARN ResolveWriteToStream: spark.sql.adaptive.enabled is not supported in streaming DataFrames/Datasets and will be disabled.
================================================================================
ALL STREAMS STARTED SUCCESSFULLY!
1. Invalid → HDFS (partitioned)
2. Clean → Fraud Detection → ClickHouse (HTTP batch)
Running... Press Ctrl+C to stop
================================================================================
25/11/27 15:41:31 WARN AdminClientConfig: These configurations '[key.deserializer, value.deserializer, enable.auto.commit, max.poll.records, auto.offset.reset]' were supplied but are not used yet.
25/11/27 15:41:31 WARN AdminClientConfig: These configurations '[key.deserializer, value.deserializer, enable.auto.commit, max.poll.records, auto.offset.reset]' were supplied but are not used yet.
HIGH_AMOUNT | Sent 18540 alerts → ClickHouse
HIGH_COUNT | Sent 435 alerts → ClickHouse
25/11/27 15:41:43 WARN GarbageCollectionMetrics: To enable non-built-in garbage collector(s) List(G1 Concurrent GC), users should configure it(them) to spark.eventLog.gcMetrics.youngGenerationGarbageCollectors or spark.eventLog.gcMetrics.oldGenerationGarbageCollectors
HIGH_AMOUNT | Sent 149 alerts → ClickHouse
HIGH_AMOUNT | Sent 160 alerts → ClickHouse
HIGH_COUNT | Sent 447 alerts → ClickHouse
HIGH_AMOUNT | Sent 157 alerts → ClickHouse
HIGH_AMOUNT | Sent 162 alerts → ClickHouse
HIGH_COUNT | Sent 492 alerts → ClickHouse
HIGH_AMOUNT | Sent 153 alerts → ClickHouse
HIGH_AMOUNT | Sent 147 alerts → ClickHouse
HIGH_COUNT | Sent 550 alerts → ClickHouse
HIGH_AMOUNT | Sent 150 alerts → ClickHouse
HIGH_AMOUNT | Sent 154 alerts → ClickHouse
HIGH_COUNT | Sent 602 alerts → ClickHouse
HIGH_AMOUNT | Sent 143 alerts → ClickHouse
HIGH_AMOUNT | Sent 139 alerts → ClickHouse
HIGH_COUNT | Sent 645 alerts → ClickHouse
HIGH_AMOUNT | Sent 137 alerts → ClickHouse
HIGH_AMOUNT | Sent 153 alerts → ClickHouse
HIGH_COUNT | Sent 689 alerts → ClickHouse
HIGH_AMOUNT | Sent 141 alerts → ClickHouse
HIGH_AMOUNT | Sent 148 alerts → ClickHouse
HIGH_COUNT | Sent 756 alerts → ClickHouse
HIGH_AMOUNT | Sent 139 alerts → ClickHouse
HIGH_AMOUNT | Sent 175 alerts → ClickHouse
HIGH_COUNT | Sent 762 alerts → ClickHouse
HIGH_AMOUNT | Sent 151 alerts → ClickHouse
HIGH_AMOUNT | Sent 128 alerts → ClickHouse
HIGH_COUNT | Sent 778 alerts → ClickHouse
HIGH_AMOUNT | Sent 153 alerts → ClickHouse
HIGH_AMOUNT | Sent 139 alerts → ClickHouse
HIGH_COUNT | Sent 792 alerts → ClickHouse
HIGH_AMOUNT | Sent 145 alerts → ClickHouse
HIGH_AMOUNT | Sent 170 alerts → ClickHouse
HIGH_COUNT | Sent 821 alerts → ClickHouse
HIGH_AMOUNT | Sent 143 alerts → ClickHouse
HIGH_AMOUNT | Sent 155 alerts → ClickHouse
HIGH_COUNT | Sent 807 alerts → ClickHouse
HIGH_AMOUNT | Sent 171 alerts → ClickHouse
HIGH_AMOUNT | Sent 160 alerts → ClickHouse
HIGH_COUNT | Sent 791 alerts → ClickHouse
HIGH_AMOUNT | Sent 167 alerts → ClickHouse
HIGH_AMOUNT | Sent 146 alerts → ClickHouse
HIGH_COUNT | Sent 790 alerts → ClickHouse
HIGH_AMOUNT | Sent 154 alerts → ClickHouse
HIGH_AMOUNT | Sent 126 alerts → ClickHouse
HIGH_COUNT | Sent 804 alerts → ClickHouse
HIGH_AMOUNT | Sent 144 alerts → ClickHouse
HIGH_AMOUNT | Sent 147 alerts → ClickHouse
HIGH_COUNT | Sent 800 alerts → ClickHouse
HIGH_AMOUNT | Sent 167 alerts → ClickHouse
HIGH_AMOUNT | Sent 151 alerts → ClickHouse
HIGH_COUNT | Sent 806 alerts → ClickHouse
HIGH_AMOUNT | Sent 155 alerts → ClickHouse
HIGH_AMOUNT | Sent 131 alerts → ClickHouse
HIGH_COUNT | Sent 810 alerts → ClickHouse
HIGH_AMOUNT | Sent 152 alerts → ClickHouse
HIGH_AMOUNT | Sent 174 alerts → ClickHouse
HIGH_COUNT | Sent 811 alerts → ClickHouse
HIGH_AMOUNT | Sent 156 alerts → ClickHouse
HIGH_AMOUNT | Sent 137 alerts → ClickHouse
HIGH_COUNT | Sent 819 alerts → ClickHouse
HIGH_AMOUNT | Sent 132 alerts → ClickHouse
HIGH_AMOUNT | Sent 144 alerts → ClickHouse
HIGH_COUNT | Sent 806 alerts → ClickHouse
HIGH_AMOUNT | Sent 140 alerts → ClickHouse
HIGH_AMOUNT | Sent 174 alerts → ClickHouse
HIGH_COUNT | Sent 790 alerts → ClickHouse
HIGH_AMOUNT | Sent 150 alerts → ClickHouse
HIGH_AMOUNT | Sent 144 alerts → ClickHouse
HIGH_COUNT | Sent 801 alerts → ClickHouse
HIGH_AMOUNT | Sent 159 alerts → ClickHouse
HIGH_AMOUNT | Sent 143 alerts → ClickHouse
HIGH_COUNT | Sent 785 alerts → ClickHouse
HIGH_AMOUNT | Sent 133 alerts → ClickHouse
HIGH_AMOUNT | Sent 148 alerts → ClickHouse
HIGH_COUNT | Sent 783 alerts → ClickHouse
HIGH_AMOUNT | Sent 169 alerts → ClickHouse
HIGH_AMOUNT | Sent 149 alerts → ClickHouse
HIGH_COUNT | Sent 810 alerts → ClickHouse
HIGH_AMOUNT | Sent 152 alerts → ClickHouse
HIGH_AMOUNT | Sent 148 alerts → ClickHouse
HIGH_COUNT | Sent 796 alerts → ClickHouse
HIGH_AMOUNT | Sent 151 alerts → ClickHouse
HIGH_AMOUNT | Sent 152 alerts → ClickHouse
HIGH_COUNT | Sent 805 alerts → ClickHouse
HIGH_AMOUNT | Sent 150 alerts → ClickHouse
HIGH_AMOUNT | Sent 177 alerts → ClickHouse
HIGH_COUNT | Sent 774 alerts → ClickHouse
HIGH_AMOUNT | Sent 152 alerts → ClickHouse
HIGH_AMOUNT | Sent 136 alerts → ClickHouse
HIGH_COUNT | Sent 802 alerts → ClickHouse
HIGH_AMOUNT | Sent 160 alerts → ClickHouse
HIGH_AMOUNT | Sent 169 alerts → ClickHouse
HIGH_COUNT | Sent 788 alerts → ClickHouse
HIGH_AMOUNT | Sent 142 alerts → ClickHouse
HIGH_AMOUNT | Sent 156 alerts → ClickHouse
HIGH_COUNT | Sent 832 alerts → ClickHouse
HIGH_AMOUNT | Sent 140 alerts → ClickHouse
HIGH_AMOUNT | Sent 145 alerts → ClickHouse
HIGH_COUNT | Sent 810 alerts → ClickHouse
HIGH_AMOUNT | Sent 152 alerts → ClickHouse
HIGH_AMOUNT | Sent 165 alerts → ClickHouse
HIGH_COUNT | Sent 805 alerts → ClickHouse
HIGH_AMOUNT | Sent 157 alerts → ClickHouse
HIGH_AMOUNT | Sent 159 alerts → ClickHouse
HIGH_COUNT | Sent 797 alerts → ClickHouse
HIGH_AMOUNT | Sent 161 alerts → ClickHouse
HIGH_AMOUNT | Sent 171 alerts → ClickHouse
HIGH_COUNT | Sent 784 alerts → ClickHouse
HIGH_AMOUNT | Sent 157 alerts → ClickHouse
HIGH_AMOUNT | Sent 147 alerts → ClickHouse
HIGH_COUNT | Sent 804 alerts → ClickHouse
HIGH_AMOUNT | Sent 149 alerts → ClickHouse
HIGH_AMOUNT | Sent 147 alerts → ClickHouse
HIGH_COUNT | Sent 794 alerts → ClickHouse
HIGH_AMOUNT | Sent 140 alerts → ClickHouse
HIGH_COUNT | Sent 553 alerts → ClickHouse

#set and count(*) on hdfs for invalid
0: jdbc:hive2://localhost:10000> MSCK REPAIR TABLE bank_transaction_invalid;
No rows affected (0.045 seconds)
0: jdbc:hive2://localhost:10000> SELECT count(*) FROM bank_transaction_invalid;
WARNING: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions.  /
Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
+--------+
|  _c0   |
+--------+
| 19993  |
+--------+
1 row selected (1.29 seconds)
0: jdbc:hive2://localhost:10000> 
# for clickhouse see:
0 rows in set. Elapsed: 0.038 sec. Processed 18.54 thousand rows, 1.92 MB (485.76 thousand rows/s., 50.19 MB/s.)
Peak memory usage: 1.50 MiB.

e3bf0ddd2588 :) select count(*) from fraud_alerts;

SELECT count(*)
FROM fraud_alerts

Query id: 90b8c258-c27f-4dfc-8e6c-d15c0b2528af

   ┌─count()─┐
1. │   60115 │
   └─────────┘

1 row in set. Elapsed: 0.007 sec. 

e3bf0ddd2588 :) select * from fraud_alerts limit 100;

SELECT *
FROM fraud_alerts
LIMIT 100

Query id: 66a955fd-4b2e-4c63-86e5-f37c9cb4946b

     ┌─transaction_id─┬─customer_id───┬─transaction_type─┬────amount─┬─currency─┬─fraud_type──┬─fraud_timestamp─┐
  1. │ 100000500891   │ ctid456996860 │ Transfer         │ 136759591 │ IRR      │ HIGH_AMOUNT │                 │
  2. │ 100000625691   │ ctid977763499 │ Transfer         │ 353268133 │ IRR      │ HIGH_AMOUNT │                 │
  3. │ 100000377482   │ ctid577428187 │ Deposit          │ 540321580 │ IRR      │ HIGH_AMOUNT │                 │
  4. │ 100000837523   │ ctid166087616 │ Withdrawal       │ 643800057 │ IRR      │ HIGH_AMOUNT │                 │
  5. │ 100000051662   │ ctid337753420 │ Deposit          │ 506729778 │ IRR      │ HIGH_AMOUNT │                 │
  6. │ 100000943251   │ ctid987985268 │ Deposit          │ 853895920 │ IRR      │ HIGH_AMOUNT │                 │
  7. │ 100000246895   │ ctid548295182 │ Deposit          │ 188637960 │ IRR      │ HIGH_AMOUNT │                 │
  8. │ 100000314674   │ ctid506871800 │ Transfer         │ 536858893 │ IRR      │ HIGH_AMOUNT │                 │
  9. │ 100000733810   │ ctid264048380 │ Transfer         │ 417026197 │ IRR      │ HIGH_AMOUNT │                 │
 10. │ 100000098605   │ ctid169273944 │ Withdrawal       │ 226791459 │ IRR      │ HIGH_AMOUNT │                 │
 11. │ 100000777379   │ ctid585304821 │ Transfer         │ 579553344 │ IRR      │ HIGH_AMOUNT │                 │
 12. │ 100000648861   │ ctid191714276 │ Withdrawal       │ 541879043 │ IRR      │ HIGH_AMOUNT │                 │
 13. │ 100000964938   │ ctid777832730 │ Transfer         │ 739075409 │ IRR      │ HIGH_AMOUNT │                 │
 14. │ 100000965854   │ ctid340246700 │ Transfer         │ 982458042 │ IRR      │ HIGH_AMOUNT │                 │
 15. │ 100000817044   │ ctid875791945 │ Transfer         │ 885630504 │ IRR      │ HIGH_AMOUNT │                 │
 16. │ 100000305340   │ ctid537385510 │ Transfer         │ 144402235 │ IRR      │ HIGH_AMOUNT │                 │
 17. │ 100000349138   │ ctid938127850 │ Withdrawal       │ 192502899 │ IRR      │ HIGH_AMOUNT │                 │
 18. │ 100000133717   │ ctid362326261 │ Transfer         │ 261576782 │ IRR      │ HIGH_AMOUNT │                 │
 19. │ 100000892518   │ ctid411495364 │ Withdrawal       │ 642875907 │ IRR      │ HIGH_AMOUNT │                 │
 20. │ 100000241721   │ ctid836617164 │ Withdrawal       │ 674489238 │ IRR      │ HIGH_AMOUNT │                 │
 21. │ 100000542038   │ ctid117585767 │ Withdrawal       │ 150596263 │ IRR      │ HIGH_AMOUNT │                 │
 22. │ 100000122581   │ ctid101818696 │ Deposit          │ 593800433 │ IRR      │ HIGH_AMOUNT │                 │
 23. │ 100000678826   │ ctid295974003 │ Deposit          │ 339456401 │ IRR      │ HIGH_AMOUNT │                 │
 24. │ 100000155552   │ ctid284394835 │ Transfer         │ 887427711 │ IRR      │ HIGH_AMOUNT │                 │
 25. │ 100000575894   │ ctid308494343 │ Deposit          │ 697331847 │ IRR      │ HIGH_AMOUNT │                 │
 26. │ 100000340736   │ ctid446453633 │ Withdrawal       │ 958183630 │ IRR      │ HIGH_AMOUNT │                 │
 27. │ 100000945333   │ ctid571016994 │ Deposit          │ 622548222 │ IRR      │ HIGH_AMOUNT │                 │
 28. │ 100000283767   │ ctid813707178 │ Transfer         │ 752904572 │ IRR      │ HIGH_AMOUNT │                 │
 29. │ 100000526747   │ ctid260180312 │ Deposit          │ 306437291 │ IRR      │ HIGH_AMOUNT │                 │
 30. │ 100000104235   │ ctid969383418 │ Withdrawal       │ 739247580 │ IRR      │ HIGH_AMOUNT │                 │
 31. │ 100000125786   │ ctid156085693 │ Transfer         │ 446573145 │ IRR      │ HIGH_AMOUNT │                 │
 32. │ 100000552547   │ ctid132420311 │ Deposit          │ 767160430 │ IRR      │ HIGH_AMOUNT │                 │
 33. │ 100000159355   │ ctid878428700 │ Transfer         │ 550898593 │ IRR      │ HIGH_AMOUNT │                 │
 34. │ 100000367836   │ ctid274941716 │ Transfer         │ 198990884 │ IRR      │ HIGH_AMOUNT │                 │
 35. │ 100000018373   │ ctid836393499 │ Deposit          │ 859459304 │ IRR      │ HIGH_AMOUNT │                 │
 36. │ 100000428730   │ ctid901901914 │ Deposit          │ 652202794 │ IRR      │ HIGH_AMOUNT │                 │
 37. │ 100000318892   │ ctid274935964 │ Transfer         │ 850969233 │ IRR      │ HIGH_AMOUNT │                 │
 38. │ 100000447840   │ ctid397708486 │ Withdrawal       │ 493942989 │ IRR      │ HIGH_AMOUNT │                 │
 39. │ 100000409239   │ ctid956205494 │ Withdrawal       │ 490469370 │ IRR      │ HIGH_AMOUNT │                 │
 40. │ 100000902174   │ ctid361877520 │ Transfer         │ 365098401 │ IRR      │ HIGH_AMOUNT │                 │
 41. │ 100000813642   │ ctid627697182 │ Deposit          │ 587543126 │ IRR      │ HIGH_AMOUNT │                 │
 42. │ 100000716048   │ ctid816752383 │ Withdrawal       │ 195427002 │ IRR      │ HIGH_AMOUNT │                 │
 43. │ 100000983331   │ ctid556329567 │ Transfer         │ 238367314 │ IRR      │ HIGH_AMOUNT │                 │
 44. │ 100000325388   │ ctid370328094 │ Withdrawal       │ 271975690 │ IRR      │ HIGH_AMOUNT │                 │
 45. │ 100000533191   │ ctid924534667 │ Deposit          │ 931380689 │ IRR      │ HIGH_AMOUNT │                 │
 46. │ 100000425682   │ ctid424239073 │ Deposit          │ 556861548 │ IRR      │ HIGH_AMOUNT │                 │
 47. │ 100000490469   │ ctid269233655 │ Deposit          │ 252659165 │ IRR      │ HIGH_AMOUNT │                 │
 48. │ 100000473883   │ ctid306075911 │ Withdrawal       │ 630444236 │ IRR      │ HIGH_AMOUNT │                 │
 49. │ 100000743821   │ ctid379501676 │ Withdrawal       │ 750538484 │ IRR      │ HIGH_AMOUNT │                 │
 50. │ 100000607627   │ ctid556546709 │ Withdrawal       │ 507502196 │ IRR      │ HIGH_AMOUNT │                 │
 51. │ 100000695258   │ ctid392093017 │ Withdrawal       │ 888058761 │ IRR      │ HIGH_AMOUNT │                 │
 52. │ 100000721732   │ ctid240746585 │ Transfer         │ 396196149 │ IRR      │ HIGH_AMOUNT │                 │
 53. │ 100000084982   │ ctid851593007 │ Deposit          │ 808912629 │ IRR      │ HIGH_AMOUNT │                 │
 54. │ 100000406535   │ ctid912064893 │ Transfer         │ 121331186 │ IRR      │ HIGH_AMOUNT │                 │
 55. │ 100000274736   │ ctid280901011 │ Transfer         │ 540103176 │ IRR      │ HIGH_AMOUNT │                 │
 56. │ 100000399341   │ ctid302922752 │ Transfer         │ 809672430 │ IRR      │ HIGH_AMOUNT │                 │
 57. │ 100000511379   │ ctid519558310 │ Deposit          │ 532691077 │ IRR      │ HIGH_AMOUNT │                 │
 58. │ 100000203123   │ ctid705616526 │ Transfer         │ 843535207 │ IRR      │ HIGH_AMOUNT │                 │
 59. │ 100000104668   │ ctid376947977 │ Deposit          │ 828592175 │ IRR      │ HIGH_AMOUNT │                 │
 60. │ 100000721267   │ ctid980653849 │ Deposit          │ 919221947 │ IRR      │ HIGH_AMOUNT │                 │
 61. │ 100000310456   │ ctid144640281 │ Withdrawal       │ 229596135 │ IRR      │ HIGH_AMOUNT │                 │
 62. │ 100000408225   │ ctid176650805 │ Withdrawal       │ 102381096 │ IRR      │ HIGH_AMOUNT │                 │
 63. │ 100000475277   │ ctid514534292 │ Deposit          │ 983514685 │ IRR      │ HIGH_AMOUNT │                 │
 64. │ 100000878555   │ ctid887351554 │ Withdrawal       │ 575202859 │ IRR      │ HIGH_AMOUNT │                 │
 65. │ 100000185446   │ ctid900390810 │ Deposit          │ 900871126 │ IRR      │ HIGH_AMOUNT │                 │
 66. │ 100000304731   │ ctid250365293 │ Withdrawal       │ 538835199 │ IRR      │ HIGH_AMOUNT │                 │
 67. │ 100000237250   │ ctid933511117 │ Transfer         │ 138716171 │ IRR      │ HIGH_AMOUNT │                 │
 68. │ 100000617869   │ ctid952994052 │ Deposit          │ 303480743 │ IRR      │ HIGH_AMOUNT │                 │
 69. │ 100000992194   │ ctid581651695 │ Deposit          │ 540644745 │ IRR      │ HIGH_AMOUNT │                 │
 70. │ 100000551421   │ ctid374403788 │ Deposit          │ 299258164 │ IRR      │ HIGH_AMOUNT │                 │
 71. │ 100000221791   │ ctid160044911 │ Withdrawal       │ 570234686 │ IRR      │ HIGH_AMOUNT │                 │
 72. │ 100000152190   │ ctid793192041 │ Withdrawal       │ 611769794 │ IRR      │ HIGH_AMOUNT │                 │
 73. │ 100000806075   │ ctid776650657 │ Deposit          │ 336481446 │ IRR      │ HIGH_AMOUNT │                 │
 74. │ 100000919547   │ ctid792450864 │ Withdrawal       │ 722236194 │ IRR      │ HIGH_AMOUNT │                 │
 75. │ 100000961381   │ ctid725303116 │ Withdrawal       │ 396964896 │ IRR      │ HIGH_AMOUNT │                 │
 76. │ 100000414821   │ ctid713449187 │ Deposit          │ 414376305 │ IRR      │ HIGH_AMOUNT │                 │
 77. │ 100000726490   │ ctid104199556 │ Transfer         │ 944007345 │ IRR      │ HIGH_AMOUNT │                 │
 78. │ 100000950798   │ ctid682974687 │ Transfer         │ 456550334 │ IRR      │ HIGH_AMOUNT │                 │
 79. │ 100000382315   │ ctid646093026 │ Withdrawal       │ 532035665 │ IRR      │ HIGH_AMOUNT │                 │
 80. │ 100000704064   │ ctid314363597 │ Transfer         │ 330875323 │ IRR      │ HIGH_AMOUNT │                 │
 81. │ 100000547864   │ ctid402099374 │ Deposit          │ 841989630 │ IRR      │ HIGH_AMOUNT │                 │
 82. │ 100000741687   │ ctid668350214 │ Deposit          │ 838346771 │ IRR      │ HIGH_AMOUNT │                 │
 83. │ 100000525635   │ ctid820708146 │ Withdrawal       │ 442612773 │ IRR      │ HIGH_AMOUNT │                 │
 84. │ 100000281486   │ ctid136808117 │ Deposit          │ 824335913 │ IRR      │ HIGH_AMOUNT │                 │
 85. │ 100000942491   │ ctid379990775 │ Withdrawal       │ 645407128 │ IRR      │ HIGH_AMOUNT │                 │
 86. │ 100000348319   │ ctid712127652 │ Transfer         │ 133926804 │ IRR      │ HIGH_AMOUNT │                 │
 87. │ 100000919873   │ ctid237098488 │ Deposit          │ 728745424 │ IRR      │ HIGH_AMOUNT │                 │
 88. │ 100000287633   │ ctid139316249 │ Deposit          │ 193121715 │ IRR      │ HIGH_AMOUNT │                 │
 89. │ 100000694305   │ ctid627302334 │ Deposit          │ 468987351 │ IRR      │ HIGH_AMOUNT │                 │
 90. │ 100000703028   │ ctid629063722 │ Withdrawal       │ 208032976 │ IRR      │ HIGH_AMOUNT │                 │
 91. │ 100000943368   │ ctid134948529 │ Deposit          │ 770454700 │ IRR      │ HIGH_AMOUNT │                 │
 92. │ 100000729725   │ ctid171786399 │ Transfer         │ 107536486 │ IRR      │ HIGH_AMOUNT │                 │
 93. │ 100000250342   │ ctid777436981 │ Transfer         │ 255246509 │ IRR      │ HIGH_AMOUNT │                 │
 94. │ 100000426652   │ ctid967263909 │ Withdrawal       │ 362347244 │ IRR      │ HIGH_AMOUNT │                 │
 95. │ 100000479066   │ ctid867770276 │ Deposit          │ 894997156 │ IRR      │ HIGH_AMOUNT │                 │
 96. │ 100000044855   │ ctid535287333 │ Deposit          │ 560153749 │ IRR      │ HIGH_AMOUNT │                 │
 97. │ 100000213409   │ ctid663486825 │ Withdrawal       │ 914859417 │ IRR      │ HIGH_AMOUNT │                 │
 98. │ 100000355000   │ ctid801816239 │ Transfer         │ 466623015 │ IRR      │ HIGH_AMOUNT │                 │
 99. │ 100000181881   │ ctid842233713 │ Deposit          │ 400101660 │ IRR      │ HIGH_AMOUNT │                 │
100. │ 100000627289   │ ctid256136110 │ Withdrawal       │ 653646570 │ IRR      │ HIGH_AMOUNT │                 │
     └─transaction_id─┴─customer_id───┴─transaction_type─┴────amount─┴─currency─┴─fraud_type──┴─fraud_timestamp─┘

100 rows in set. Elapsed: 0.005 sec. Processed 18.54 thousand rows, 1.92 MB (3.52 million rows/s., 363.96 MB/s.)
Peak memory usage: 1.51 MiB.

e3bf0ddd2588 :) 